{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./resources/js/controllers/news_controller.js","webpack:///./resources/js/controllers/current_time_controller.js","webpack:///./resources/js/controllers/news_time_controller.js","webpack:///./resources/js/controllers/redirect_controller.js","webpack:///./resources/js/controllers/story_items_controller.js","webpack:///./resources/js/lib/format_date.js","webpack:///./node_modules/@stimulus/core/dist/src/event_listener.js","webpack:///./node_modules/@stimulus/core/dist/src/dispatcher.js","webpack:///./node_modules/@stimulus/core/dist/src/action_descriptor.js","webpack:///./node_modules/@stimulus/core/dist/src/action.js","webpack:///./node_modules/@stimulus/core/dist/src/binding.js","webpack:///./node_modules/@stimulus/mutation-observers/dist/src/element_observer.js","webpack:///./node_modules/@stimulus/mutation-observers/dist/src/attribute_observer.js","webpack:///./node_modules/@stimulus/multimap/dist/src/set_operations.js","webpack:///./node_modules/@stimulus/multimap/dist/src/multimap.js","webpack:///./node_modules/@stimulus/multimap/dist/src/indexed_multimap.js","webpack:///./node_modules/@stimulus/mutation-observers/dist/src/token_list_observer.js","webpack:///./node_modules/@stimulus/mutation-observers/dist/src/value_list_observer.js","webpack:///./node_modules/@stimulus/core/dist/src/binding_observer.js","webpack:///./node_modules/@stimulus/core/dist/src/context.js","webpack:///./node_modules/@stimulus/core/dist/src/definition.js","webpack:///./node_modules/@stimulus/core/dist/src/module.js","webpack:///./node_modules/@stimulus/core/dist/src/data_map.js","webpack:///./node_modules/@stimulus/core/dist/src/selectors.js","webpack:///./node_modules/@stimulus/core/dist/src/target_set.js","webpack:///./node_modules/@stimulus/core/dist/src/scope.js","webpack:///./node_modules/@stimulus/core/dist/src/scope_observer.js","webpack:///./node_modules/@stimulus/core/dist/src/router.js","webpack:///./node_modules/@stimulus/core/dist/src/schema.js","webpack:///./node_modules/@stimulus/core/dist/src/application.js","webpack:///./node_modules/@stimulus/core/dist/src/target_properties.js","webpack:///./node_modules/@stimulus/core/dist/src/controller.js","webpack:///./resources/js/app.js","webpack:///./node_modules/@stimulus/webpack-helpers/dist/index.js","webpack:///./resources/js/controllers/share_controller.js","webpack:///./resources/js/controllers sync \\.js$","webpack:///./node_modules/regenerator-runtime/runtime.js","webpack:///./node_modules/@babel/runtime/regenerator/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","this","newsTemplate","document","getElementById","innerHTML","addEventListener","loadMoreNews","getNews","news","values","sort","a","b","Date","pubDate","fetch","response","ok","json","template","params","entries","reduce","memo","val","replace","RegExp","loading","needLoad","itemTargets","lastIndex","length","element","classList","add","slice","forEach","_item","item","link","internalLink","div","createElement","renderTemplate","newsTarget","appendChild","targets","rect","getBoundingClientRect","bottom","top","window","innerHeight","documentElement","clientHeight","Controller","tick","updateDay","updateWeek","updateHours","updateMinutes","updateMonth","timer","setInterval","dayNumber","monthNumber","dayTarget","textContent","getDate","hours","getHours","hoursTarget","pad","minutes","getMinutes","minutesTarget","month","getMonth","monthTarget","week","getDay","weekTarget","getWeekDay","number","toString","padStart","clearInterval","timeSince","innerText","trim","baseURI","data","referrer","includes","location","getElementsByClassName","remove","showMoreBtnTarget","formatLong","dateStr","date","DD","MM","YY","getFullYear","HH","mm","SS","getSeconds","seconds","Math","floor","getTime","cases","amount","periodCases","_interval","interval","periodText","getTimeSinceInterval","getTimeSinceArrow","arrowFun","EventListener","eventTarget","eventName","unorderedBindings","Set","connect","disconnect","removeEventListener","bindingConnected","binding","bindingDisconnected","delete","handleEvent","event","extendedEvent","stopImmediatePropagation_1","stopImmediatePropagation","assign","immediatePropagationStopped","extendEvent","_i","_a","bindings","Array","from","left","right","leftIndex","index","rightIndex","configurable","Dispatcher","application","eventListenerMaps","Map","started","start","eventListeners","eventListener","stop","listeners","map","concat","fetchEventListenerForBinding","handleError","error","message","detail","fetchEventListener","eventListenerMap","fetchEventListenerMapForEventTarget","createEventListener","set","descriptorPattern","Action","descriptor","tagName","toLowerCase","defaultEventNames","getDefaultEventNameForElement","identifier","methodName","forToken","token","descriptorString","content","matches","match","eventTargetName","eventNameSuffix","e","getAttribute","Error","Binding","context","action","willBeInvokedByEvent","invokeWithEvent","method","controller","target","Element","contains","scope","containsElement","ElementObserver","delegate","_this","elements","mutationObserver","MutationObserver","mutations","processMutations","observe","attributes","childList","subtree","refresh","takeRecords","matchElementsInTree","has","removeElement","_b","_c","addElement","mutations_1","mutation","processMutation","type","processAttributeChange","attributeName","processRemovedNodes","removedNodes","processAddedNodes","addedNodes","node","elementAttributeChanged","matchElement","nodes","elementFromNode","processTree","elementIsActive","tree","processor","nodeType","Node","ELEMENT_NODE","isConnected","elementMatched","elementUnmatched","AttributeObserver","elementObserver","hasAttribute","querySelectorAll","selector","elementMatchedAttribute","elementUnmatchedAttribute","elementAttributeValueChanged","del","size","prune","extendStatics","Multimap","valuesByKey","hasKey","hasValue","some","getValuesForKey","getKeysForValue","filter","__extends","setPrototypeOf","__proto__","__","constructor","_super","IndexedMultimap","keysByValue","keys","TokenListObserver","attributeObserver","tokensByElement","tokensMatched","readTokensForElement","refreshTokensForElement","unmatchedTokens","matchedTokens","tokensUnmatched","tokens","tokenMatched","tokenUnmatched","previousTokens","currentTokens","firstDifferingIndex","max","_","findIndex","tokensAreEqual","tokenString","split","parseTokenString","ValueListObserver","tokenListObserver","parseResultsByToken","WeakMap","valuesByTokenByElement","fetchParseResultForToken","fetchValuesByTokenForElement","elementMatchedValue","elementUnmatchedValue","parseResult","parseToken","valuesByToken","parseValueForToken","BindingObserver","bindingsByAction","valueListObserver","actionAttribute","disconnectAllActions","schema","connectAction","disconnectAction","clear","Context","controllerConstructor","bindingObserver","dispatcher","initialize","parentElement","blessControllerConstructor","extend","bless","extendWithReflect","_newTarget","Reflect","construct","arguments","apply","Module","definition","blessDefinition","contextsByScope","connectedContexts","connectContextForScope","fetchContextForScope","disconnectContextForScope","DataMap","getFormattedKey","setAttribute","removeAttribute","char","attributeValueContainsToken","TargetSet","targetName","find","targetNames","getSelectorForTargetNames","findElement","findAll","findAllElements","getSelectorForTargetName","join","targetDescriptor","targetAttribute","Scope","head","tail","filterElements","closest","controllerSelector","controllerAttribute","ScopeObserver","scopesByIdentifierByElement","scopeReferenceCounts","scopesByIdentifier","fetchScopesByIdentifierForElement","referenceCount","scopeConnected","scopeDisconnected","Router","scopeObserver","modulesByIdentifier","contexts","loadDefinition","unloadIdentifier","connectModule","disconnectModule","getContextForElementAndIdentifier","defaultSchema","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","then","__generator","body","f","y","g","label","sent","trys","ops","verb","iterator","v","op","TypeError","pop","push","Application","router","readyState","register","load","rest","definitions","isArray","unload","identifiers","getControllerForElementAndIdentifier","console","defineTargetProperties","ancestors","getPrototypeOf","getAncestorsForConstructor","getOwnTargetNamesForConstructor","getTargetNamesForConstructor","properties","charAt","toUpperCase","capitalize","require","logicalName","identifierForContextKey","default","definitionForModuleAndIdentifier","definitionForModuleWithContextAndKey","definitionsFromContext","popupCenter","url","title","w","h","screen","width","height","open","webpackContext","req","id","webpackContextResolve","code","runtime","Op","hasOwn","$Symbol","iteratorSymbol","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","_invoke","state","arg","doneResult","delegateResult","maybeInvokeDelegate","ContinueSentinel","_sent","dispatchException","abrupt","record","tryCatch","makeInvokeMethod","fn","obj","err","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","NativeIteratorPrototype","Gp","defineIteratorMethods","AsyncIterator","PromiseImpl","previousPromise","callInvokeWithMethodAndArg","invoke","__await","unwrapped","undefined","info","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","displayName","isGeneratorFunction","genFun","ctor","mark","awrap","async","iter","reverse","skipTempReset","prev","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","regeneratorRuntime","accidentalStrictMode","Function"],"mappings":"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","file":"/js/app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/* eslint-disable no-useless-escape */\nimport { Controller } from 'stimulus';\n\nconst PORTION_COUNT = 7;\n\nexport default class extends Controller {\n    static targets = ['item', 'news'];\n\n    loading = false;\n\n    async connect() {\n        this.newsTemplate = document.getElementById('news-template').innerHTML;\n\n        document.addEventListener('scroll', () => this.loadMoreNews());\n\n        this.news = Object.values(await this.getNews()).sort(\n            (a, b) => new Date(b.pubDate) - new Date(a.pubDate),\n        );\n        this.loadMoreNews();\n    }\n\n    async getNews() {\n        const response = await fetch('/api/last-news.json');\n        if (response.ok) {\n            return response.json();\n        }\n    }\n\n    renderTemplate(template, params) {\n        return Object.entries(params).reduce(\n            (memo, [key, val]) =>\n                memo.replace(\n                    // eslint-disable-next-line no-useless-escape\n                    new RegExp(`\\\\{\\\\{\\\\s*\\\\$${key}\\\\s*\\\\}\\\\}`, 'gm'),\n                    val,\n                ),\n            template,\n        );\n    }\n\n    loadMoreNews() {\n        if (!this.news || this.loading || !this.needLoad(this.itemTargets)) {\n            return;\n        }\n\n        this.loading = true;\n\n        const lastIndex = this.itemTargets.length;\n\n        if (lastIndex === this.news.length) {\n            this.element.classList.add('news-ended');\n        }\n\n        this.news.slice(lastIndex, lastIndex + PORTION_COUNT).forEach(\n            _item => {\n                const item = {\n                    ..._item,\n                    link: _item.internalLink,\n                };\n\n                const div = document.createElement('div');\n                div.innerHTML = this.renderTemplate(this.newsTemplate, item);\n\n                this.newsTarget.appendChild(div);\n            },\n\n            '',\n        );\n\n        this.loading = false;\n\n        return this.loadMoreNews();\n    }\n\n    needLoad(targets) {\n        const lastTarget = targets[targets.length - 1];\n        const rect = lastTarget.getBoundingClientRect();\n\n        return (\n            rect.bottom !== 0 &&\n            rect.top <\n                (window.innerHeight || document.documentElement.clientHeight) +\n                    300\n        );\n    }\n}\n","import { Controller } from 'stimulus';\n\nexport default class extends Controller {\n    /**\n     *\n     * @type {[string, string]}\n     */\n    static targets = ['minutes', 'hours', 'month', 'day', 'week'];\n\n    /**\n     *\n     */\n    connect() {\n        const tick = () =>\n            this.updateDay()\n                .updateWeek()\n                .updateHours()\n                .updateMinutes()\n                .updateMonth();\n\n        tick();\n\n        this.timer = setInterval(tick, 10000);\n    }\n\n    /**\n     *\n     * @returns {string}\n     */\n    getWeekDay(dayNumber) {\n        return [\n            'воскресенье',\n            'понедельник',\n            'вторник',\n            'среда',\n            'четверг',\n            'пятница',\n            'суббота',\n        ][dayNumber];\n    }\n\n    /**\n     *\n     * @returns {string}\n     */\n    getMonth(monthNumber) {\n        return [\n            'января',\n            'февраля',\n            'марта',\n            'апреля',\n            'мая',\n            'июня',\n            'июля',\n            'августа',\n            'сентября',\n            'октября',\n            'ноября',\n            'декабря',\n        ][monthNumber];\n    }\n\n    /**\n     *\n     */\n    updateDay() {\n        this.dayTarget.textContent = new Date().getDate();\n\n        return this;\n    }\n\n    /**\n     *\n     */\n    updateHours() {\n        let hours = new Date().getHours();\n        this.hoursTarget.textContent = this.pad(hours);\n\n        return this;\n    }\n\n    /**\n     *\n     */\n    updateMinutes() {\n        let minutes = new Date().getMinutes();\n        this.minutesTarget.textContent = this.pad(minutes);\n\n        return this;\n    }\n\n    /**\n     *\n     */\n    updateMonth() {\n        let month = new Date().getMonth();\n        this.monthTarget.textContent = this.getMonth(month);\n\n        return this;\n    }\n\n    /**\n     *\n     */\n    updateWeek() {\n        let week = new Date().getDay();\n        this.weekTarget.textContent = this.getWeekDay(week);\n\n        return this;\n    }\n\n    /**\n     *\n     * @param number\n     * @returns {string|*}\n     */\n    pad(number) {\n        return number.toString().padStart(2, 0);\n    }\n\n    /**\n     * Clear time\n     */\n    disconnect() {\n        clearInterval(this.timer);\n    }\n}\n","import { Controller } from 'stimulus';\nimport { timeSince } from '../lib/format_date';\n\nexport default class extends Controller {\n    initialize() {\n        this.element.innerHTML = timeSince(this.element.innerText.trim());\n    }\n}\n","import {Controller} from 'stimulus';\n\nexport default class extends Controller {\n    initialize() {\n        const baseURI = document.baseURI;\n\n        if (this.data.get('url') === '') {\n            return;\n        }\n\n        if (document.referrer.includes(baseURI)) {\n            window.location.replace(this.data.get('url'));\n        }\n    }\n}\n","import { Controller } from 'stimulus';\n\nexport default class extends Controller {\n    static get targets() {\n        return ['showMoreBtn'];\n    }\n\n    show() {\n        const items = this.element.getElementsByClassName('d-none');\n\n        for (const item of items) {\n            item.classList.remove('d-none');\n        }\n\n        this.showMoreBtnTarget.classList.add('d-none');\n    }\n}\n","/**\n *\n * @param {Date} date\n */\nexports.formatLong = dateStr => {\n    const date = new Date(dateStr);\n    const DD = date\n        .getDate()\n        .toString()\n        .padStart(2, 0);\n    const MM = (date.getMonth() + 1)\n        .toString()\n        .toString()\n        .padStart(2, 0);\n    const YY = date.getFullYear();\n    const HH = date\n        .getHours()\n        .toString()\n        .padStart(2, 0);\n    const mm = date\n        .getMinutes()\n        .toString()\n        .padStart(2, 0);\n    const SS = date\n        .getSeconds()\n        .toString()\n        .padStart(2, 0);\n\n    return `${YY}-${MM}-${DD} ${HH}:${mm}:${SS}`;\n};\n\nconst getTimeSinceArrow = seconds =>\n    seconds > 0 ? t => `${t} назад` : t => `через ${t}`;\n\nconst getTimeSinceInterval = seconds => {\n    const cases = [2, 0, 1, 1, 1, 2];\n\n    const periods = [\n        [31536000, ['год', 'года', 'лет']],\n        [2592000, ['месяц', 'месяца', 'месяцев']],\n        [86400, ['день', 'дня', 'дней']],\n        [3600, ['час', 'часа', 'часов']],\n        [60, ['минуту', 'минуты', 'минут']],\n    ];\n\n    for (const [amount, periodCases] of periods) {\n        const _interval = seconds / amount;\n        const interval = Math.floor(_interval);\n\n        if (_interval > 1) {\n            return {\n                interval,\n                periodText:\n                    periodCases[\n                        interval % 100 > 4 && interval % 100 < 20\n                            ? 2\n                            : cases[interval % 10 < 5 ? interval % 10 : 5]\n                    ],\n            };\n        }\n    }\n    return { interval: 0 };\n};\n\nexports.timeSince = dateStr => {\n    const seconds = Math.floor(\n        (new Date().getTime() - new Date(dateStr).getTime()) / 1000,\n    );\n    const { interval, periodText } = getTimeSinceInterval(seconds);\n\n    if (interval === 0) {\n        return 'только что';\n    }\n\n    const arrowFun = getTimeSinceArrow(seconds);\n\n    return arrowFun(`${interval} ${periodText}`);\n};\n","var EventListener = /** @class */ (function () {\n    function EventListener(eventTarget, eventName) {\n        this.eventTarget = eventTarget;\n        this.eventName = eventName;\n        this.unorderedBindings = new Set;\n    }\n    EventListener.prototype.connect = function () {\n        this.eventTarget.addEventListener(this.eventName, this, false);\n    };\n    EventListener.prototype.disconnect = function () {\n        this.eventTarget.removeEventListener(this.eventName, this, false);\n    };\n    // Binding observer delegate\n    /** @hidden */\n    EventListener.prototype.bindingConnected = function (binding) {\n        this.unorderedBindings.add(binding);\n    };\n    /** @hidden */\n    EventListener.prototype.bindingDisconnected = function (binding) {\n        this.unorderedBindings.delete(binding);\n    };\n    EventListener.prototype.handleEvent = function (event) {\n        var extendedEvent = extendEvent(event);\n        for (var _i = 0, _a = this.bindings; _i < _a.length; _i++) {\n            var binding = _a[_i];\n            if (extendedEvent.immediatePropagationStopped) {\n                break;\n            }\n            else {\n                binding.handleEvent(extendedEvent);\n            }\n        }\n    };\n    Object.defineProperty(EventListener.prototype, \"bindings\", {\n        get: function () {\n            return Array.from(this.unorderedBindings).sort(function (left, right) {\n                var leftIndex = left.index, rightIndex = right.index;\n                return leftIndex < rightIndex ? -1 : leftIndex > rightIndex ? 1 : 0;\n            });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return EventListener;\n}());\nexport { EventListener };\nfunction extendEvent(event) {\n    if (\"immediatePropagationStopped\" in event) {\n        return event;\n    }\n    else {\n        var stopImmediatePropagation_1 = event.stopImmediatePropagation;\n        return Object.assign(event, {\n            immediatePropagationStopped: false,\n            stopImmediatePropagation: function () {\n                this.immediatePropagationStopped = true;\n                stopImmediatePropagation_1.call(this);\n            }\n        });\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXZlbnRfbGlzdGVuZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZXZlbnRfbGlzdGVuZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUE7SUFLRSx1QkFBWSxXQUF3QixFQUFFLFNBQWlCO1FBQ3JELElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFBO1FBQzlCLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFBO1FBQzFCLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLEdBQUcsQ0FBQTtJQUNsQyxDQUFDO0lBRUQsK0JBQU8sR0FBUDtRQUNFLElBQUksQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUE7SUFDaEUsQ0FBQztJQUVELGtDQUFVLEdBQVY7UUFDRSxJQUFJLENBQUMsV0FBVyxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFBO0lBQ25FLENBQUM7SUFFRCw0QkFBNEI7SUFFNUIsY0FBYztJQUNkLHdDQUFnQixHQUFoQixVQUFpQixPQUFnQjtRQUMvQixJQUFJLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ3JDLENBQUM7SUFFRCxjQUFjO0lBQ2QsMkNBQW1CLEdBQW5CLFVBQW9CLE9BQWdCO1FBQ2xDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUE7SUFDeEMsQ0FBQztJQUVELG1DQUFXLEdBQVgsVUFBWSxLQUFZO1FBQ3RCLElBQU0sYUFBYSxHQUFHLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUN4QyxLQUFzQixVQUFhLEVBQWIsS0FBQSxJQUFJLENBQUMsUUFBUSxFQUFiLGNBQWEsRUFBYixJQUFhLEVBQUU7WUFBaEMsSUFBTSxPQUFPLFNBQUE7WUFDaEIsSUFBSSxhQUFhLENBQUMsMkJBQTJCLEVBQUU7Z0JBQzdDLE1BQUs7YUFDTjtpQkFBTTtnQkFDTCxPQUFPLENBQUMsV0FBVyxDQUFDLGFBQWEsQ0FBQyxDQUFBO2FBQ25DO1NBQ0Y7SUFDSCxDQUFDO0lBRUQsc0JBQUksbUNBQVE7YUFBWjtZQUNFLE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQyxJQUFJLEVBQUUsS0FBSztnQkFDekQsSUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssRUFBRSxVQUFVLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQTtnQkFDdEQsT0FBTyxTQUFTLEdBQUcsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7WUFDckUsQ0FBQyxDQUFDLENBQUE7UUFDSixDQUFDOzs7T0FBQTtJQUNILG9CQUFDO0FBQUQsQ0FBQyxBQWhERCxJQWdEQzs7QUFFRCxxQkFBcUIsS0FBWTtJQUMvQixJQUFJLDZCQUE2QixJQUFJLEtBQUssRUFBRTtRQUMxQyxPQUFPLEtBQUssQ0FBQTtLQUNiO1NBQU07UUFDRyxJQUFBLDJEQUF3QixDQUFVO1FBQzFDLE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUU7WUFDMUIsMkJBQTJCLEVBQUUsS0FBSztZQUNsQyx3QkFBd0I7Z0JBQ3RCLElBQUksQ0FBQywyQkFBMkIsR0FBRyxJQUFJLENBQUE7Z0JBQ3ZDLDBCQUF3QixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQTtZQUNyQyxDQUFDO1NBQ0YsQ0FBQyxDQUFBO0tBQ0g7QUFDSCxDQUFDIn0=","import { EventListener } from \"./event_listener\";\nvar Dispatcher = /** @class */ (function () {\n    function Dispatcher(application) {\n        this.application = application;\n        this.eventListenerMaps = new Map;\n        this.started = false;\n    }\n    Dispatcher.prototype.start = function () {\n        if (!this.started) {\n            this.started = true;\n            this.eventListeners.forEach(function (eventListener) { return eventListener.connect(); });\n        }\n    };\n    Dispatcher.prototype.stop = function () {\n        if (this.started) {\n            this.started = false;\n            this.eventListeners.forEach(function (eventListener) { return eventListener.disconnect(); });\n        }\n    };\n    Object.defineProperty(Dispatcher.prototype, \"eventListeners\", {\n        get: function () {\n            return Array.from(this.eventListenerMaps.values())\n                .reduce(function (listeners, map) { return listeners.concat(Array.from(map.values())); }, []);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // Binding observer delegate\n    /** @hidden */\n    Dispatcher.prototype.bindingConnected = function (binding) {\n        this.fetchEventListenerForBinding(binding).bindingConnected(binding);\n    };\n    /** @hidden */\n    Dispatcher.prototype.bindingDisconnected = function (binding) {\n        this.fetchEventListenerForBinding(binding).bindingDisconnected(binding);\n    };\n    // Error handling\n    Dispatcher.prototype.handleError = function (error, message, detail) {\n        if (detail === void 0) { detail = {}; }\n        this.application.handleError(error, \"Error \" + message, detail);\n    };\n    Dispatcher.prototype.fetchEventListenerForBinding = function (binding) {\n        var eventTarget = binding.eventTarget, eventName = binding.eventName;\n        return this.fetchEventListener(eventTarget, eventName);\n    };\n    Dispatcher.prototype.fetchEventListener = function (eventTarget, eventName) {\n        var eventListenerMap = this.fetchEventListenerMapForEventTarget(eventTarget);\n        var eventListener = eventListenerMap.get(eventName);\n        if (!eventListener) {\n            eventListener = this.createEventListener(eventTarget, eventName);\n            eventListenerMap.set(eventName, eventListener);\n        }\n        return eventListener;\n    };\n    Dispatcher.prototype.createEventListener = function (eventTarget, eventName) {\n        var eventListener = new EventListener(eventTarget, eventName);\n        if (this.started) {\n            eventListener.connect();\n        }\n        return eventListener;\n    };\n    Dispatcher.prototype.fetchEventListenerMapForEventTarget = function (eventTarget) {\n        var eventListenerMap = this.eventListenerMaps.get(eventTarget);\n        if (!eventListenerMap) {\n            eventListenerMap = new Map;\n            this.eventListenerMaps.set(eventTarget, eventListenerMap);\n        }\n        return eventListenerMap;\n    };\n    return Dispatcher;\n}());\nexport { Dispatcher };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGlzcGF0Y2hlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaXNwYXRjaGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdBLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQTtBQUVoRDtJQUtFLG9CQUFZLFdBQXdCO1FBQ2xDLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFBO1FBQzlCLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLEdBQUcsQ0FBQTtRQUNoQyxJQUFJLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQTtJQUN0QixDQUFDO0lBRUQsMEJBQUssR0FBTDtRQUNFLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2pCLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFBO1lBQ25CLElBQUksQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLFVBQUEsYUFBYSxJQUFJLE9BQUEsYUFBYSxDQUFDLE9BQU8sRUFBRSxFQUF2QixDQUF1QixDQUFDLENBQUE7U0FDdEU7SUFDSCxDQUFDO0lBRUQseUJBQUksR0FBSjtRQUNFLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNoQixJQUFJLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQTtZQUNwQixJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxVQUFBLGFBQWEsSUFBSSxPQUFBLGFBQWEsQ0FBQyxVQUFVLEVBQUUsRUFBMUIsQ0FBMEIsQ0FBQyxDQUFBO1NBQ3pFO0lBQ0gsQ0FBQztJQUVELHNCQUFJLHNDQUFjO2FBQWxCO1lBQ0UsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLEVBQUUsQ0FBQztpQkFDL0MsTUFBTSxDQUFDLFVBQUMsU0FBUyxFQUFFLEdBQUcsSUFBSyxPQUFBLFNBQVMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxFQUExQyxDQUEwQyxFQUFFLEVBQXFCLENBQUMsQ0FBQTtRQUNsRyxDQUFDOzs7T0FBQTtJQUVELDRCQUE0QjtJQUU1QixjQUFjO0lBQ2QscUNBQWdCLEdBQWhCLFVBQWlCLE9BQWdCO1FBQy9CLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxPQUFPLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsQ0FBQTtJQUN0RSxDQUFDO0lBRUQsY0FBYztJQUNkLHdDQUFtQixHQUFuQixVQUFvQixPQUFnQjtRQUNsQyxJQUFJLENBQUMsNEJBQTRCLENBQUMsT0FBTyxDQUFDLENBQUMsbUJBQW1CLENBQUMsT0FBTyxDQUFDLENBQUE7SUFDekUsQ0FBQztJQUVELGlCQUFpQjtJQUVqQixnQ0FBVyxHQUFYLFVBQVksS0FBWSxFQUFFLE9BQWUsRUFBRSxNQUFtQjtRQUFuQix1QkFBQSxFQUFBLFdBQW1CO1FBQzVELElBQUksQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSxXQUFTLE9BQVMsRUFBRSxNQUFNLENBQUMsQ0FBQTtJQUNqRSxDQUFDO0lBRU8saURBQTRCLEdBQXBDLFVBQXFDLE9BQWdCO1FBQzNDLElBQUEsaUNBQVcsRUFBRSw2QkFBUyxDQUFZO1FBQzFDLE9BQU8sSUFBSSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsRUFBRSxTQUFTLENBQUMsQ0FBQTtJQUN4RCxDQUFDO0lBRU8sdUNBQWtCLEdBQTFCLFVBQTJCLFdBQXdCLEVBQUUsU0FBaUI7UUFDcEUsSUFBTSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsbUNBQW1DLENBQUMsV0FBVyxDQUFDLENBQUE7UUFDOUUsSUFBSSxhQUFhLEdBQUcsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFBO1FBQ25ELElBQUksQ0FBQyxhQUFhLEVBQUU7WUFDbEIsYUFBYSxHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxXQUFXLEVBQUUsU0FBUyxDQUFDLENBQUE7WUFDaEUsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxhQUFhLENBQUMsQ0FBQTtTQUMvQztRQUNELE9BQU8sYUFBYSxDQUFBO0lBQ3RCLENBQUM7SUFFTyx3Q0FBbUIsR0FBM0IsVUFBNEIsV0FBd0IsRUFBRSxTQUFpQjtRQUNyRSxJQUFNLGFBQWEsR0FBRyxJQUFJLGFBQWEsQ0FBQyxXQUFXLEVBQUUsU0FBUyxDQUFDLENBQUE7UUFDL0QsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2hCLGFBQWEsQ0FBQyxPQUFPLEVBQUUsQ0FBQTtTQUN4QjtRQUNELE9BQU8sYUFBYSxDQUFBO0lBQ3RCLENBQUM7SUFFTyx3REFBbUMsR0FBM0MsVUFBNEMsV0FBd0I7UUFDbEUsSUFBSSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFBO1FBQzlELElBQUksQ0FBQyxnQkFBZ0IsRUFBRTtZQUNyQixnQkFBZ0IsR0FBRyxJQUFJLEdBQUcsQ0FBQTtZQUMxQixJQUFJLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFBO1NBQzFEO1FBQ0QsT0FBTyxnQkFBZ0IsQ0FBQTtJQUN6QixDQUFDO0lBQ0gsaUJBQUM7QUFBRCxDQUFDLEFBL0VELElBK0VDIn0=","// capture nos.:            12   23 4               43   1 5   56 7  76\nvar descriptorPattern = /^((.+?)(@(window|document))?->)?(.+?)(#(.+))?$/;\nexport function parseDescriptorString(descriptorString) {\n    var source = descriptorString.trim();\n    var matches = source.match(descriptorPattern) || [];\n    return {\n        eventTarget: parseEventTarget(matches[4]),\n        eventName: matches[2],\n        identifier: matches[5],\n        methodName: matches[7]\n    };\n}\nfunction parseEventTarget(eventTargetName) {\n    if (eventTargetName == \"window\") {\n        return window;\n    }\n    else if (eventTargetName == \"document\") {\n        return document;\n    }\n}\nexport function stringifyEventTarget(eventTarget) {\n    if (eventTarget == window) {\n        return \"window\";\n    }\n    else if (eventTarget == document) {\n        return \"document\";\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWN0aW9uX2Rlc2NyaXB0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvYWN0aW9uX2Rlc2NyaXB0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBT0EsdUVBQXVFO0FBQ3ZFLElBQU0saUJBQWlCLEdBQUcsZ0RBQWdELENBQUE7QUFFMUUsTUFBTSxnQ0FBZ0MsZ0JBQXdCO0lBQzVELElBQU0sTUFBTSxHQUFHLGdCQUFnQixDQUFDLElBQUksRUFBRSxDQUFBO0lBQ3RDLElBQU0sT0FBTyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsSUFBSSxFQUFFLENBQUE7SUFDckQsT0FBTztRQUNMLFdBQVcsRUFBRSxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDekMsU0FBUyxFQUFJLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDdkIsVUFBVSxFQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDdkIsVUFBVSxFQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUM7S0FDeEIsQ0FBQTtBQUNILENBQUM7QUFFRCwwQkFBMEIsZUFBdUI7SUFDL0MsSUFBSSxlQUFlLElBQUksUUFBUSxFQUFFO1FBQy9CLE9BQU8sTUFBTSxDQUFBO0tBQ2Q7U0FBTSxJQUFJLGVBQWUsSUFBSSxVQUFVLEVBQUU7UUFDeEMsT0FBTyxRQUFRLENBQUE7S0FDaEI7QUFDSCxDQUFDO0FBRUQsTUFBTSwrQkFBK0IsV0FBd0I7SUFDM0QsSUFBSSxXQUFXLElBQUksTUFBTSxFQUFFO1FBQ3pCLE9BQU8sUUFBUSxDQUFBO0tBQ2hCO1NBQU0sSUFBSSxXQUFXLElBQUksUUFBUSxFQUFFO1FBQ2xDLE9BQU8sVUFBVSxDQUFBO0tBQ2xCO0FBQ0gsQ0FBQyJ9","import { parseDescriptorString, stringifyEventTarget } from \"./action_descriptor\";\nvar Action = /** @class */ (function () {\n    function Action(element, index, descriptor) {\n        this.element = element;\n        this.index = index;\n        this.eventTarget = descriptor.eventTarget || element;\n        this.eventName = descriptor.eventName || getDefaultEventNameForElement(element) || error(\"missing event name\");\n        this.identifier = descriptor.identifier || error(\"missing identifier\");\n        this.methodName = descriptor.methodName || error(\"missing method name\");\n    }\n    Action.forToken = function (token) {\n        return new this(token.element, token.index, parseDescriptorString(token.content));\n    };\n    Action.prototype.toString = function () {\n        var eventNameSuffix = this.eventTargetName ? \"@\" + this.eventTargetName : \"\";\n        return \"\" + this.eventName + eventNameSuffix + \"->\" + this.identifier + \"#\" + this.methodName;\n    };\n    Object.defineProperty(Action.prototype, \"eventTargetName\", {\n        get: function () {\n            return stringifyEventTarget(this.eventTarget);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Action;\n}());\nexport { Action };\nvar defaultEventNames = {\n    \"a\": function (e) { return \"click\"; },\n    \"button\": function (e) { return \"click\"; },\n    \"form\": function (e) { return \"submit\"; },\n    \"input\": function (e) { return e.getAttribute(\"type\") == \"submit\" ? \"click\" : \"change\"; },\n    \"select\": function (e) { return \"change\"; },\n    \"textarea\": function (e) { return \"change\"; }\n};\nexport function getDefaultEventNameForElement(element) {\n    var tagName = element.tagName.toLowerCase();\n    if (tagName in defaultEventNames) {\n        return defaultEventNames[tagName](element);\n    }\n}\nfunction error(message) {\n    throw new Error(message);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWN0aW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2FjdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQW9CLHFCQUFxQixFQUFFLG9CQUFvQixFQUFFLE1BQU0scUJBQXFCLENBQUE7QUFHbkc7SUFZRSxnQkFBWSxPQUFnQixFQUFFLEtBQWEsRUFBRSxVQUFxQztRQUNoRixJQUFJLENBQUMsT0FBTyxHQUFPLE9BQU8sQ0FBQTtRQUMxQixJQUFJLENBQUMsS0FBSyxHQUFTLEtBQUssQ0FBQTtRQUN4QixJQUFJLENBQUMsV0FBVyxHQUFHLFVBQVUsQ0FBQyxXQUFXLElBQUksT0FBTyxDQUFBO1FBQ3BELElBQUksQ0FBQyxTQUFTLEdBQUssVUFBVSxDQUFDLFNBQVMsSUFBSSw2QkFBNkIsQ0FBQyxPQUFPLENBQUMsSUFBSSxLQUFLLENBQUMsb0JBQW9CLENBQUMsQ0FBQTtRQUNoSCxJQUFJLENBQUMsVUFBVSxHQUFJLFVBQVUsQ0FBQyxVQUFVLElBQUksS0FBSyxDQUFDLG9CQUFvQixDQUFDLENBQUE7UUFDdkUsSUFBSSxDQUFDLFVBQVUsR0FBSSxVQUFVLENBQUMsVUFBVSxJQUFJLEtBQUssQ0FBQyxxQkFBcUIsQ0FBQyxDQUFBO0lBQzFFLENBQUM7SUFYTSxlQUFRLEdBQWYsVUFBZ0IsS0FBWTtRQUMxQixPQUFPLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLEtBQUssRUFBRSxxQkFBcUIsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQTtJQUNuRixDQUFDO0lBV0QseUJBQVEsR0FBUjtRQUNFLElBQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLE1BQUksSUFBSSxDQUFDLGVBQWlCLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtRQUM5RSxPQUFPLEtBQUcsSUFBSSxDQUFDLFNBQVMsR0FBRyxlQUFlLFVBQUssSUFBSSxDQUFDLFVBQVUsU0FBSSxJQUFJLENBQUMsVUFBWSxDQUFBO0lBQ3JGLENBQUM7SUFFRCxzQkFBWSxtQ0FBZTthQUEzQjtZQUNFLE9BQU8sb0JBQW9CLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFBO1FBQy9DLENBQUM7OztPQUFBO0lBQ0gsYUFBQztBQUFELENBQUMsQUE3QkQsSUE2QkM7O0FBRUQsSUFBTSxpQkFBaUIsR0FBd0Q7SUFDN0UsR0FBRyxFQUFTLFVBQUEsQ0FBQyxJQUFJLE9BQUEsT0FBTyxFQUFQLENBQU87SUFDeEIsUUFBUSxFQUFJLFVBQUEsQ0FBQyxJQUFJLE9BQUEsT0FBTyxFQUFQLENBQU87SUFDeEIsTUFBTSxFQUFNLFVBQUEsQ0FBQyxJQUFJLE9BQUEsUUFBUSxFQUFSLENBQVE7SUFDekIsT0FBTyxFQUFLLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUF2RCxDQUF1RDtJQUN4RSxRQUFRLEVBQUksVUFBQSxDQUFDLElBQUksT0FBQSxRQUFRLEVBQVIsQ0FBUTtJQUN6QixVQUFVLEVBQUUsVUFBQSxDQUFDLElBQUksT0FBQSxRQUFRLEVBQVIsQ0FBUTtDQUMxQixDQUFBO0FBRUQsTUFBTSx3Q0FBd0MsT0FBZ0I7SUFDNUQsSUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsQ0FBQTtJQUM3QyxJQUFJLE9BQU8sSUFBSSxpQkFBaUIsRUFBRTtRQUNoQyxPQUFPLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0tBQzNDO0FBQ0gsQ0FBQztBQUVELGVBQWUsT0FBZTtJQUM1QixNQUFNLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0FBQzFCLENBQUMifQ==","var Binding = /** @class */ (function () {\n    function Binding(context, action) {\n        this.context = context;\n        this.action = action;\n    }\n    Object.defineProperty(Binding.prototype, \"index\", {\n        get: function () {\n            return this.action.index;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Binding.prototype, \"eventTarget\", {\n        get: function () {\n            return this.action.eventTarget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Binding.prototype, \"identifier\", {\n        get: function () {\n            return this.context.identifier;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Binding.prototype.handleEvent = function (event) {\n        if (this.willBeInvokedByEvent(event)) {\n            this.invokeWithEvent(event);\n        }\n    };\n    Object.defineProperty(Binding.prototype, \"eventName\", {\n        get: function () {\n            return this.action.eventName;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Binding.prototype, \"method\", {\n        get: function () {\n            var method = this.controller[this.methodName];\n            if (typeof method == \"function\") {\n                return method;\n            }\n            throw new Error(\"Action \\\"\" + this.action + \"\\\" references undefined method \\\"\" + this.methodName + \"\\\"\");\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Binding.prototype.invokeWithEvent = function (event) {\n        try {\n            this.method.call(this.controller, event);\n        }\n        catch (error) {\n            var _a = this, identifier = _a.identifier, controller = _a.controller, element = _a.element, index = _a.index;\n            var detail = { identifier: identifier, controller: controller, element: element, index: index, event: event };\n            this.context.handleError(error, \"invoking action \\\"\" + this.action + \"\\\"\", detail);\n        }\n    };\n    Binding.prototype.willBeInvokedByEvent = function (event) {\n        var eventTarget = event.target;\n        if (this.element === eventTarget) {\n            return true;\n        }\n        else if (eventTarget instanceof Element && this.element.contains(eventTarget)) {\n            return this.scope.containsElement(eventTarget);\n        }\n        else {\n            return true;\n        }\n    };\n    Object.defineProperty(Binding.prototype, \"controller\", {\n        get: function () {\n            return this.context.controller;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Binding.prototype, \"methodName\", {\n        get: function () {\n            return this.action.methodName;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Binding.prototype, \"element\", {\n        get: function () {\n            return this.scope.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Binding.prototype, \"scope\", {\n        get: function () {\n            return this.context.scope;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Binding;\n}());\nexport { Binding };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmluZGluZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9iaW5kaW5nLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUtBO0lBSUUsaUJBQVksT0FBZ0IsRUFBRSxNQUFjO1FBQzFDLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFBO1FBQ3RCLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFBO0lBQ3RCLENBQUM7SUFFRCxzQkFBSSwwQkFBSzthQUFUO1lBQ0UsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQTtRQUMxQixDQUFDOzs7T0FBQTtJQUVELHNCQUFJLGdDQUFXO2FBQWY7WUFDRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFBO1FBQ2hDLENBQUM7OztPQUFBO0lBRUQsc0JBQUksK0JBQVU7YUFBZDtZQUNFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUE7UUFDaEMsQ0FBQzs7O09BQUE7SUFFRCw2QkFBVyxHQUFYLFVBQVksS0FBWTtRQUN0QixJQUFJLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUNwQyxJQUFJLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFBO1NBQzVCO0lBQ0gsQ0FBQztJQUVELHNCQUFJLDhCQUFTO2FBQWI7WUFDRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFBO1FBQzlCLENBQUM7OztPQUFBO0lBRUQsc0JBQUksMkJBQU07YUFBVjtZQUNFLElBQU0sTUFBTSxHQUFJLElBQUksQ0FBQyxVQUFrQixDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQTtZQUN4RCxJQUFJLE9BQU8sTUFBTSxJQUFJLFVBQVUsRUFBRTtnQkFDL0IsT0FBTyxNQUFNLENBQUE7YUFDZDtZQUNELE1BQU0sSUFBSSxLQUFLLENBQUMsY0FBVyxJQUFJLENBQUMsTUFBTSx5Q0FBa0MsSUFBSSxDQUFDLFVBQVUsT0FBRyxDQUFDLENBQUE7UUFDN0YsQ0FBQzs7O09BQUE7SUFFTyxpQ0FBZSxHQUF2QixVQUF3QixLQUFZO1FBQ2xDLElBQUk7WUFDRixJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLEtBQUssQ0FBQyxDQUFBO1NBQ3pDO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDUixJQUFBLFNBQWlELEVBQS9DLDBCQUFVLEVBQUUsMEJBQVUsRUFBRSxvQkFBTyxFQUFFLGdCQUFLLENBQVM7WUFDdkQsSUFBTSxNQUFNLEdBQUcsRUFBRSxVQUFVLFlBQUEsRUFBRSxVQUFVLFlBQUEsRUFBRSxPQUFPLFNBQUEsRUFBRSxLQUFLLE9BQUEsRUFBRSxLQUFLLE9BQUEsRUFBRSxDQUFBO1lBQ2hFLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSx1QkFBb0IsSUFBSSxDQUFDLE1BQU0sT0FBRyxFQUFFLE1BQU0sQ0FBQyxDQUFBO1NBQzVFO0lBQ0gsQ0FBQztJQUVPLHNDQUFvQixHQUE1QixVQUE2QixLQUFZO1FBQ3ZDLElBQU0sV0FBVyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUE7UUFDaEMsSUFBSSxJQUFJLENBQUMsT0FBTyxLQUFLLFdBQVcsRUFBRTtZQUNoQyxPQUFPLElBQUksQ0FBQTtTQUNaO2FBQU0sSUFBSSxXQUFXLFlBQVksT0FBTyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQy9FLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUMsV0FBVyxDQUFDLENBQUE7U0FDL0M7YUFBTTtZQUNMLE9BQU8sSUFBSSxDQUFBO1NBQ1o7SUFDSCxDQUFDO0lBRUQsc0JBQVksK0JBQVU7YUFBdEI7WUFDRSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFBO1FBQ2hDLENBQUM7OztPQUFBO0lBRUQsc0JBQVksK0JBQVU7YUFBdEI7WUFDRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFBO1FBQy9CLENBQUM7OztPQUFBO0lBRUQsc0JBQVksNEJBQU87YUFBbkI7WUFDRSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFBO1FBQzNCLENBQUM7OztPQUFBO0lBRUQsc0JBQVksMEJBQUs7YUFBakI7WUFDRSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFBO1FBQzNCLENBQUM7OztPQUFBO0lBQ0gsY0FBQztBQUFELENBQUMsQUEzRUQsSUEyRUMifQ==","var ElementObserver = /** @class */ (function () {\n    function ElementObserver(element, delegate) {\n        var _this = this;\n        this.element = element;\n        this.started = false;\n        this.delegate = delegate;\n        this.elements = new Set;\n        this.mutationObserver = new MutationObserver(function (mutations) { return _this.processMutations(mutations); });\n    }\n    ElementObserver.prototype.start = function () {\n        if (!this.started) {\n            this.started = true;\n            this.mutationObserver.observe(this.element, { attributes: true, childList: true, subtree: true });\n            this.refresh();\n        }\n    };\n    ElementObserver.prototype.stop = function () {\n        if (this.started) {\n            this.mutationObserver.takeRecords();\n            this.mutationObserver.disconnect();\n            this.started = false;\n        }\n    };\n    ElementObserver.prototype.refresh = function () {\n        if (this.started) {\n            var matches = new Set(this.matchElementsInTree());\n            for (var _i = 0, _a = Array.from(this.elements); _i < _a.length; _i++) {\n                var element = _a[_i];\n                if (!matches.has(element)) {\n                    this.removeElement(element);\n                }\n            }\n            for (var _b = 0, _c = Array.from(matches); _b < _c.length; _b++) {\n                var element = _c[_b];\n                this.addElement(element);\n            }\n        }\n    };\n    // Mutation record processing\n    ElementObserver.prototype.processMutations = function (mutations) {\n        if (this.started) {\n            for (var _i = 0, mutations_1 = mutations; _i < mutations_1.length; _i++) {\n                var mutation = mutations_1[_i];\n                this.processMutation(mutation);\n            }\n        }\n    };\n    ElementObserver.prototype.processMutation = function (mutation) {\n        if (mutation.type == \"attributes\") {\n            this.processAttributeChange(mutation.target, mutation.attributeName);\n        }\n        else if (mutation.type == \"childList\") {\n            this.processRemovedNodes(mutation.removedNodes);\n            this.processAddedNodes(mutation.addedNodes);\n        }\n    };\n    ElementObserver.prototype.processAttributeChange = function (node, attributeName) {\n        var element = node;\n        if (this.elements.has(element)) {\n            if (this.delegate.elementAttributeChanged && this.matchElement(element)) {\n                this.delegate.elementAttributeChanged(element, attributeName);\n            }\n            else {\n                this.removeElement(element);\n            }\n        }\n        else if (this.matchElement(element)) {\n            this.addElement(element);\n        }\n    };\n    ElementObserver.prototype.processRemovedNodes = function (nodes) {\n        for (var _i = 0, _a = Array.from(nodes); _i < _a.length; _i++) {\n            var node = _a[_i];\n            var element = this.elementFromNode(node);\n            if (element) {\n                this.processTree(element, this.removeElement);\n            }\n        }\n    };\n    ElementObserver.prototype.processAddedNodes = function (nodes) {\n        for (var _i = 0, _a = Array.from(nodes); _i < _a.length; _i++) {\n            var node = _a[_i];\n            var element = this.elementFromNode(node);\n            if (element && this.elementIsActive(element)) {\n                this.processTree(element, this.addElement);\n            }\n        }\n    };\n    // Element matching\n    ElementObserver.prototype.matchElement = function (element) {\n        return this.delegate.matchElement(element);\n    };\n    ElementObserver.prototype.matchElementsInTree = function (tree) {\n        if (tree === void 0) { tree = this.element; }\n        return this.delegate.matchElementsInTree(tree);\n    };\n    ElementObserver.prototype.processTree = function (tree, processor) {\n        for (var _i = 0, _a = this.matchElementsInTree(tree); _i < _a.length; _i++) {\n            var element = _a[_i];\n            processor.call(this, element);\n        }\n    };\n    ElementObserver.prototype.elementFromNode = function (node) {\n        if (node.nodeType == Node.ELEMENT_NODE) {\n            return node;\n        }\n    };\n    ElementObserver.prototype.elementIsActive = function (element) {\n        if (element.isConnected != this.element.isConnected) {\n            return false;\n        }\n        else {\n            return this.element.contains(element);\n        }\n    };\n    // Element tracking\n    ElementObserver.prototype.addElement = function (element) {\n        if (!this.elements.has(element)) {\n            if (this.elementIsActive(element)) {\n                this.elements.add(element);\n                if (this.delegate.elementMatched) {\n                    this.delegate.elementMatched(element);\n                }\n            }\n        }\n    };\n    ElementObserver.prototype.removeElement = function (element) {\n        if (this.elements.has(element)) {\n            this.elements.delete(element);\n            if (this.delegate.elementUnmatched) {\n                this.delegate.elementUnmatched(element);\n            }\n        }\n    };\n    return ElementObserver;\n}());\nexport { ElementObserver };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWxlbWVudF9vYnNlcnZlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9lbGVtZW50X29ic2VydmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQVNBO0lBUUUseUJBQVksT0FBZ0IsRUFBRSxRQUFpQztRQUEvRCxpQkFPQztRQU5DLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFBO1FBQ3RCLElBQUksQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFBO1FBQ3BCLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFBO1FBRXhCLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxHQUFHLENBQUE7UUFDdkIsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksZ0JBQWdCLENBQUMsVUFBQyxTQUFTLElBQUssT0FBQSxLQUFJLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxDQUFDLEVBQWhDLENBQWdDLENBQUMsQ0FBQTtJQUMvRixDQUFDO0lBRUQsK0JBQUssR0FBTDtRQUNFLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2pCLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFBO1lBQ25CLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQTtZQUNqRyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUE7U0FDZjtJQUNILENBQUM7SUFFRCw4QkFBSSxHQUFKO1FBQ0UsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2hCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtZQUNuQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxFQUFFLENBQUE7WUFDbEMsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUE7U0FDckI7SUFDSCxDQUFDO0lB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","import { ElementObserver } from \"./element_observer\";\nvar AttributeObserver = /** @class */ (function () {\n    function AttributeObserver(element, attributeName, delegate) {\n        this.attributeName = attributeName;\n        this.delegate = delegate;\n        this.elementObserver = new ElementObserver(element, this);\n    }\n    Object.defineProperty(AttributeObserver.prototype, \"element\", {\n        get: function () {\n            return this.elementObserver.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AttributeObserver.prototype, \"selector\", {\n        get: function () {\n            return \"[\" + this.attributeName + \"]\";\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AttributeObserver.prototype.start = function () {\n        this.elementObserver.start();\n    };\n    AttributeObserver.prototype.stop = function () {\n        this.elementObserver.stop();\n    };\n    AttributeObserver.prototype.refresh = function () {\n        this.elementObserver.refresh();\n    };\n    Object.defineProperty(AttributeObserver.prototype, \"started\", {\n        get: function () {\n            return this.elementObserver.started;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // Element observer delegate\n    AttributeObserver.prototype.matchElement = function (element) {\n        return element.hasAttribute(this.attributeName);\n    };\n    AttributeObserver.prototype.matchElementsInTree = function (tree) {\n        var match = this.matchElement(tree) ? [tree] : [];\n        var matches = Array.from(tree.querySelectorAll(this.selector));\n        return match.concat(matches);\n    };\n    AttributeObserver.prototype.elementMatched = function (element) {\n        if (this.delegate.elementMatchedAttribute) {\n            this.delegate.elementMatchedAttribute(element, this.attributeName);\n        }\n    };\n    AttributeObserver.prototype.elementUnmatched = function (element) {\n        if (this.delegate.elementUnmatchedAttribute) {\n            this.delegate.elementUnmatchedAttribute(element, this.attributeName);\n        }\n    };\n    AttributeObserver.prototype.elementAttributeChanged = function (element, attributeName) {\n        if (this.delegate.elementAttributeValueChanged && this.attributeName == attributeName) {\n            this.delegate.elementAttributeValueChanged(element, attributeName);\n        }\n    };\n    return AttributeObserver;\n}());\nexport { AttributeObserver };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXR0cmlidXRlX29ic2VydmVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2F0dHJpYnV0ZV9vYnNlcnZlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsZUFBZSxFQUEyQixNQUFNLG9CQUFvQixDQUFBO0FBUTdFO0lBTUUsMkJBQVksT0FBZ0IsRUFBRSxhQUFxQixFQUFFLFFBQW1DO1FBQ3RGLElBQUksQ0FBQyxhQUFhLEdBQUcsYUFBYSxDQUFBO1FBQ2xDLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFBO1FBRXhCLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxlQUFlLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFBO0lBQzNELENBQUM7SUFFRCxzQkFBSSxzQ0FBTzthQUFYO1lBQ0UsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQTtRQUNyQyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLHVDQUFRO2FBQVo7WUFDRSxPQUFPLE1BQUksSUFBSSxDQUFDLGFBQWEsTUFBRyxDQUFBO1FBQ2xDLENBQUM7OztPQUFBO0lBRUQsaUNBQUssR0FBTDtRQUNFLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLENBQUE7SUFDOUIsQ0FBQztJQUVELGdDQUFJLEdBQUo7UUFDRSxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksRUFBRSxDQUFBO0lBQzdCLENBQUM7SUFFRCxtQ0FBTyxHQUFQO1FBQ0UsSUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLEVBQUUsQ0FBQTtJQUNoQyxDQUFDO0lBRUQsc0JBQUksc0NBQU87YUFBWDtZQUNFLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUE7UUFDckMsQ0FBQzs7O09BQUE7SUFFRCw0QkFBNEI7SUFFNUIsd0NBQVksR0FBWixVQUFhLE9BQWdCO1FBQzNCLE9BQU8sT0FBTyxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUE7SUFDakQsQ0FBQztJQUVELCtDQUFtQixHQUFuQixVQUFvQixJQUFhO1FBQy9CLElBQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtRQUNuRCxJQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQTtRQUNoRSxPQUFPLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUE7SUFDOUIsQ0FBQztJQUVELDBDQUFjLEdBQWQsVUFBZSxPQUFnQjtRQUM3QixJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsdUJBQXVCLEVBQUU7WUFDekMsSUFBSSxDQUFDLFFBQVEsQ0FBQyx1QkFBdUIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFBO1NBQ25FO0lBQ0gsQ0FBQztJQUVELDRDQUFnQixHQUFoQixVQUFpQixPQUFnQjtRQUMvQixJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMseUJBQXlCLEVBQUU7WUFDM0MsSUFBSSxDQUFDLFFBQVEsQ0FBQyx5QkFBeUIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFBO1NBQ3JFO0lBQ0gsQ0FBQztJQUVELG1EQUF1QixHQUF2QixVQUF3QixPQUFnQixFQUFFLGFBQXFCO1FBQzdELElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyw0QkFBNEIsSUFBSSxJQUFJLENBQUMsYUFBYSxJQUFJLGFBQWEsRUFBRTtZQUNyRixJQUFJLENBQUMsUUFBUSxDQUFDLDRCQUE0QixDQUFDLE9BQU8sRUFBRSxhQUFhLENBQUMsQ0FBQTtTQUNuRTtJQUNILENBQUM7SUFDSCx3QkFBQztBQUFELENBQUMsQUFsRUQsSUFrRUMifQ==","export function add(map, key, value) {\n    fetch(map, key).add(value);\n}\nexport function del(map, key, value) {\n    fetch(map, key).delete(value);\n    prune(map, key);\n}\nexport function fetch(map, key) {\n    var values = map.get(key);\n    if (!values) {\n        values = new Set();\n        map.set(key, values);\n    }\n    return values;\n}\nexport function prune(map, key) {\n    var values = map.get(key);\n    if (values != null && values.size == 0) {\n        map.delete(key);\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0X29wZXJhdGlvbnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc2V0X29wZXJhdGlvbnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTSxjQUFvQixHQUFtQixFQUFFLEdBQU0sRUFBRSxLQUFRO0lBQzdELEtBQUssQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFBO0FBQzVCLENBQUM7QUFFRCxNQUFNLGNBQW9CLEdBQW1CLEVBQUUsR0FBTSxFQUFFLEtBQVE7SUFDN0QsS0FBSyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUE7SUFDN0IsS0FBSyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQTtBQUNqQixDQUFDO0FBRUQsTUFBTSxnQkFBc0IsR0FBbUIsRUFBRSxHQUFNO0lBQ3JELElBQUksTUFBTSxHQUFHLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDekIsSUFBSSxDQUFDLE1BQU0sRUFBRTtRQUNYLE1BQU0sR0FBRyxJQUFJLEdBQUcsRUFBRSxDQUFBO1FBQ2xCLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxDQUFBO0tBQ3JCO0lBQ0QsT0FBTyxNQUFNLENBQUE7QUFDZixDQUFDO0FBRUQsTUFBTSxnQkFBc0IsR0FBbUIsRUFBRSxHQUFNO0lBQ3JELElBQU0sTUFBTSxHQUFHLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDM0IsSUFBSSxNQUFNLElBQUksSUFBSSxJQUFJLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQyxFQUFFO1FBQ3RDLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUE7S0FDaEI7QUFDSCxDQUFDIn0=","import { add, del } from \"./set_operations\";\nvar Multimap = /** @class */ (function () {\n    function Multimap() {\n        this.valuesByKey = new Map();\n    }\n    Object.defineProperty(Multimap.prototype, \"values\", {\n        get: function () {\n            var sets = Array.from(this.valuesByKey.values());\n            return sets.reduce(function (values, set) { return values.concat(Array.from(set)); }, []);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Multimap.prototype, \"size\", {\n        get: function () {\n            var sets = Array.from(this.valuesByKey.values());\n            return sets.reduce(function (size, set) { return size + set.size; }, 0);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Multimap.prototype.add = function (key, value) {\n        add(this.valuesByKey, key, value);\n    };\n    Multimap.prototype.delete = function (key, value) {\n        del(this.valuesByKey, key, value);\n    };\n    Multimap.prototype.has = function (key, value) {\n        var values = this.valuesByKey.get(key);\n        return values != null && values.has(value);\n    };\n    Multimap.prototype.hasKey = function (key) {\n        return this.valuesByKey.has(key);\n    };\n    Multimap.prototype.hasValue = function (value) {\n        var sets = Array.from(this.valuesByKey.values());\n        return sets.some(function (set) { return set.has(value); });\n    };\n    Multimap.prototype.getValuesForKey = function (key) {\n        var values = this.valuesByKey.get(key);\n        return values ? Array.from(values) : [];\n    };\n    Multimap.prototype.getKeysForValue = function (value) {\n        return Array.from(this.valuesByKey)\n            .filter(function (_a) {\n            var key = _a[0], values = _a[1];\n            return values.has(value);\n        })\n            .map(function (_a) {\n            var key = _a[0], values = _a[1];\n            return key;\n        });\n    };\n    return Multimap;\n}());\nexport { Multimap };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXVsdGltYXAuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvbXVsdGltYXAudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQTtBQUUzQztJQUdFO1FBQ0UsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLEdBQUcsRUFBYSxDQUFBO0lBQ3pDLENBQUM7SUFFRCxzQkFBSSw0QkFBTTthQUFWO1lBQ0UsSUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUE7WUFDbEQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQUMsTUFBTSxFQUFFLEdBQUcsSUFBSyxPQUFBLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUE5QixDQUE4QixFQUFRLEVBQUUsQ0FBQyxDQUFBO1FBQy9FLENBQUM7OztPQUFBO0lBRUQsc0JBQUksMEJBQUk7YUFBUjtZQUNFLElBQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFBO1lBQ2xELE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFDLElBQUksRUFBRSxHQUFHLElBQUssT0FBQSxJQUFJLEdBQUcsR0FBRyxDQUFDLElBQUksRUFBZixDQUFlLEVBQUUsQ0FBQyxDQUFDLENBQUE7UUFDdkQsQ0FBQzs7O09BQUE7SUFFRCxzQkFBRyxHQUFILFVBQUksR0FBTSxFQUFFLEtBQVE7UUFDbEIsR0FBRyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFBO0lBQ25DLENBQUM7SUFFRCx5QkFBTSxHQUFOLFVBQU8sR0FBTSxFQUFFLEtBQVE7UUFDckIsR0FBRyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFBO0lBQ25DLENBQUM7SUFFRCxzQkFBRyxHQUFILFVBQUksR0FBTSxFQUFFLEtBQVE7UUFDbEIsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDeEMsT0FBTyxNQUFNLElBQUksSUFBSSxJQUFJLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUE7SUFDNUMsQ0FBQztJQUVELHlCQUFNLEdBQU4sVUFBTyxHQUFNO1FBQ1gsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQTtJQUNsQyxDQUFDO0lBRUQsMkJBQVEsR0FBUixVQUFTLEtBQVE7UUFDZixJQUFNLElBQUksR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQTtRQUNsRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBQSxHQUFHLElBQUksT0FBQSxHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFkLENBQWMsQ0FBQyxDQUFBO0lBQ3pDLENBQUM7SUFFRCxrQ0FBZSxHQUFmLFVBQWdCLEdBQU07UUFDcEIsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDeEMsT0FBTyxNQUFNLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtJQUN6QyxDQUFDO0lBRUQsa0NBQWUsR0FBZixVQUFnQixLQUFRO1FBQ3RCLE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDO2FBQ2hDLE1BQU0sQ0FBQyxVQUFDLEVBQWE7Z0JBQVosV0FBRyxFQUFFLGNBQU07WUFBTSxPQUFBLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDO1FBQWpCLENBQWlCLENBQUM7YUFDNUMsR0FBRyxDQUFDLFVBQUMsRUFBYTtnQkFBWixXQUFHLEVBQUUsY0FBTTtZQUFNLE9BQUEsR0FBRztRQUFILENBQUcsQ0FBQyxDQUFBO0lBQ2hDLENBQUM7SUFDSCxlQUFDO0FBQUQsQ0FBQyxBQWpERCxJQWlEQyJ9","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Multimap } from \"./multimap\";\nimport { add, del } from \"./set_operations\";\nvar IndexedMultimap = /** @class */ (function (_super) {\n    __extends(IndexedMultimap, _super);\n    function IndexedMultimap() {\n        var _this = _super.call(this) || this;\n        _this.keysByValue = new Map;\n        return _this;\n    }\n    Object.defineProperty(IndexedMultimap.prototype, \"values\", {\n        get: function () {\n            return Array.from(this.keysByValue.keys());\n        },\n        enumerable: true,\n        configurable: true\n    });\n    IndexedMultimap.prototype.add = function (key, value) {\n        _super.prototype.add.call(this, key, value);\n        add(this.keysByValue, value, key);\n    };\n    IndexedMultimap.prototype.delete = function (key, value) {\n        _super.prototype.delete.call(this, key, value);\n        del(this.keysByValue, value, key);\n    };\n    IndexedMultimap.prototype.hasValue = function (value) {\n        return this.keysByValue.has(value);\n    };\n    IndexedMultimap.prototype.getKeysForValue = function (value) {\n        var set = this.keysByValue.get(value);\n        return set ? Array.from(set) : [];\n    };\n    return IndexedMultimap;\n}(Multimap));\nexport { IndexedMultimap };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXhlZF9tdWx0aW1hcC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9pbmRleGVkX211bHRpbWFwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sWUFBWSxDQUFBO0FBQ3JDLE9BQU8sRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLE1BQU0sa0JBQWtCLENBQUE7QUFFM0M7SUFBMkMsbUNBQWM7SUFHdkQ7UUFBQSxZQUNFLGlCQUFPLFNBRVI7UUFEQyxLQUFJLENBQUMsV0FBVyxHQUFHLElBQUksR0FBRyxDQUFBOztJQUM1QixDQUFDO0lBRUQsc0JBQUksbUNBQU07YUFBVjtZQUNFLE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUE7UUFDNUMsQ0FBQzs7O09BQUE7SUFFRCw2QkFBRyxHQUFILFVBQUksR0FBTSxFQUFFLEtBQVE7UUFDbEIsaUJBQU0sR0FBRyxZQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQTtRQUNyQixHQUFHLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUE7SUFDbkMsQ0FBQztJQUVELGdDQUFNLEdBQU4sVUFBTyxHQUFNLEVBQUUsS0FBUTtRQUNyQixpQkFBTSxNQUFNLFlBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFBO1FBQ3hCLEdBQUcsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLEtBQUssRUFBRSxHQUFHLENBQUMsQ0FBQTtJQUNuQyxDQUFDO0lBRUQsa0NBQVEsR0FBUixVQUFTLEtBQVE7UUFDZixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFBO0lBQ3BDLENBQUM7SUFFRCx5Q0FBZSxHQUFmLFVBQWdCLEtBQVE7UUFDdEIsSUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDdkMsT0FBTyxHQUFHLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtJQUNuQyxDQUFDO0lBQ0gsc0JBQUM7QUFBRCxDQUFDLEFBOUJELENBQTJDLFFBQVEsR0E4QmxEIn0=","import { AttributeObserver } from \"./attribute_observer\";\nimport { Multimap } from \"@stimulus/multimap\";\nvar TokenListObserver = /** @class */ (function () {\n    function TokenListObserver(element, attributeName, delegate) {\n        this.attributeObserver = new AttributeObserver(element, attributeName, this);\n        this.delegate = delegate;\n        this.tokensByElement = new Multimap;\n    }\n    Object.defineProperty(TokenListObserver.prototype, \"started\", {\n        get: function () {\n            return this.attributeObserver.started;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TokenListObserver.prototype.start = function () {\n        this.attributeObserver.start();\n    };\n    TokenListObserver.prototype.stop = function () {\n        this.attributeObserver.stop();\n    };\n    TokenListObserver.prototype.refresh = function () {\n        this.attributeObserver.refresh();\n    };\n    Object.defineProperty(TokenListObserver.prototype, \"element\", {\n        get: function () {\n            return this.attributeObserver.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TokenListObserver.prototype, \"attributeName\", {\n        get: function () {\n            return this.attributeObserver.attributeName;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // Attribute observer delegate\n    TokenListObserver.prototype.elementMatchedAttribute = function (element) {\n        this.tokensMatched(this.readTokensForElement(element));\n    };\n    TokenListObserver.prototype.elementAttributeValueChanged = function (element) {\n        var _a = this.refreshTokensForElement(element), unmatchedTokens = _a[0], matchedTokens = _a[1];\n        this.tokensUnmatched(unmatchedTokens);\n        this.tokensMatched(matchedTokens);\n    };\n    TokenListObserver.prototype.elementUnmatchedAttribute = function (element) {\n        this.tokensUnmatched(this.tokensByElement.getValuesForKey(element));\n    };\n    TokenListObserver.prototype.tokensMatched = function (tokens) {\n        var _this = this;\n        tokens.forEach(function (token) { return _this.tokenMatched(token); });\n    };\n    TokenListObserver.prototype.tokensUnmatched = function (tokens) {\n        var _this = this;\n        tokens.forEach(function (token) { return _this.tokenUnmatched(token); });\n    };\n    TokenListObserver.prototype.tokenMatched = function (token) {\n        this.delegate.tokenMatched(token);\n        this.tokensByElement.add(token.element, token);\n    };\n    TokenListObserver.prototype.tokenUnmatched = function (token) {\n        this.delegate.tokenUnmatched(token);\n        this.tokensByElement.delete(token.element, token);\n    };\n    TokenListObserver.prototype.refreshTokensForElement = function (element) {\n        var previousTokens = this.tokensByElement.getValuesForKey(element);\n        var currentTokens = this.readTokensForElement(element);\n        var firstDifferingIndex = zip(previousTokens, currentTokens)\n            .findIndex(function (_a) {\n            var previousToken = _a[0], currentToken = _a[1];\n            return !tokensAreEqual(previousToken, currentToken);\n        });\n        if (firstDifferingIndex == -1) {\n            return [[], []];\n        }\n        else {\n            return [previousTokens.slice(firstDifferingIndex), currentTokens.slice(firstDifferingIndex)];\n        }\n    };\n    TokenListObserver.prototype.readTokensForElement = function (element) {\n        var attributeName = this.attributeName;\n        var tokenString = element.getAttribute(attributeName) || \"\";\n        return parseTokenString(tokenString, element, attributeName);\n    };\n    return TokenListObserver;\n}());\nexport { TokenListObserver };\nfunction parseTokenString(tokenString, element, attributeName) {\n    return tokenString.trim().split(/\\s+/).filter(function (content) { return content.length; })\n        .map(function (content, index) { return ({ element: element, attributeName: attributeName, content: content, index: index }); });\n}\nfunction zip(left, right) {\n    var length = Math.max(left.length, right.length);\n    return Array.from({ length: length }, function (_, index) { return [left[index], right[index]]; });\n}\nfunction tokensAreEqual(left, right) {\n    return left && right && left.index == right.index && left.content == right.content;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9rZW5fbGlzdF9vYnNlcnZlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90b2tlbl9saXN0X29ic2VydmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxpQkFBaUIsRUFBNkIsTUFBTSxzQkFBc0IsQ0FBQTtBQUNuRixPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sb0JBQW9CLENBQUE7QUFjN0M7SUFLRSwyQkFBWSxPQUFnQixFQUFFLGFBQXFCLEVBQUUsUUFBbUM7UUFDdEYsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksaUJBQWlCLENBQUMsT0FBTyxFQUFFLGFBQWEsRUFBRSxJQUFJLENBQUMsQ0FBQTtRQUM1RSxJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQTtRQUN4QixJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksUUFBUSxDQUFBO0lBQ3JDLENBQUM7SUFFRCxzQkFBSSxzQ0FBTzthQUFYO1lBQ0UsT0FBTyxJQUFJLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFBO1FBQ3ZDLENBQUM7OztPQUFBO0lBRUQsaUNBQUssR0FBTDtRQUNFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLEVBQUUsQ0FBQTtJQUNoQyxDQUFDO0lBRUQsZ0NBQUksR0FBSjtRQUNFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtJQUMvQixDQUFDO0lBRUQsbUNBQU8sR0FBUDtRQUNFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLEVBQUUsQ0FBQTtJQUNsQyxDQUFDO0lBRUQsc0JBQUksc0NBQU87YUFBWDtZQUNFLE9BQU8sSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQTtRQUN2QyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLDRDQUFhO2FBQWpCO1lBQ0UsT0FBTyxJQUFJLENBQUMsaUJBQWlCLENBQUMsYUFBYSxDQUFBO1FBQzdDLENBQUM7OztPQUFBO0lBRUQsOEJBQThCO0lB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","import { TokenListObserver } from \"./token_list_observer\";\nvar ValueListObserver = /** @class */ (function () {\n    function ValueListObserver(element, attributeName, delegate) {\n        this.tokenListObserver = new TokenListObserver(element, attributeName, this);\n        this.delegate = delegate;\n        this.parseResultsByToken = new WeakMap;\n        this.valuesByTokenByElement = new WeakMap;\n    }\n    Object.defineProperty(ValueListObserver.prototype, \"started\", {\n        get: function () {\n            return this.tokenListObserver.started;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ValueListObserver.prototype.start = function () {\n        this.tokenListObserver.start();\n    };\n    ValueListObserver.prototype.stop = function () {\n        this.tokenListObserver.stop();\n    };\n    ValueListObserver.prototype.refresh = function () {\n        this.tokenListObserver.refresh();\n    };\n    Object.defineProperty(ValueListObserver.prototype, \"element\", {\n        get: function () {\n            return this.tokenListObserver.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ValueListObserver.prototype, \"attributeName\", {\n        get: function () {\n            return this.tokenListObserver.attributeName;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ValueListObserver.prototype.tokenMatched = function (token) {\n        var element = token.element;\n        var value = this.fetchParseResultForToken(token).value;\n        if (value) {\n            this.fetchValuesByTokenForElement(element).set(token, value);\n            this.delegate.elementMatchedValue(element, value);\n        }\n    };\n    ValueListObserver.prototype.tokenUnmatched = function (token) {\n        var element = token.element;\n        var value = this.fetchParseResultForToken(token).value;\n        if (value) {\n            this.fetchValuesByTokenForElement(element).delete(token);\n            this.delegate.elementUnmatchedValue(element, value);\n        }\n    };\n    ValueListObserver.prototype.fetchParseResultForToken = function (token) {\n        var parseResult = this.parseResultsByToken.get(token);\n        if (!parseResult) {\n            parseResult = this.parseToken(token);\n            this.parseResultsByToken.set(token, parseResult);\n        }\n        return parseResult;\n    };\n    ValueListObserver.prototype.fetchValuesByTokenForElement = function (element) {\n        var valuesByToken = this.valuesByTokenByElement.get(element);\n        if (!valuesByToken) {\n            valuesByToken = new Map;\n            this.valuesByTokenByElement.set(element, valuesByToken);\n        }\n        return valuesByToken;\n    };\n    ValueListObserver.prototype.parseToken = function (token) {\n        try {\n            var value = this.delegate.parseValueForToken(token);\n            return { value: value };\n        }\n        catch (error) {\n            return { error: error };\n        }\n    };\n    return ValueListObserver;\n}());\nexport { ValueListObserver };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsdWVfbGlzdF9vYnNlcnZlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy92YWx1ZV9saXN0X29ic2VydmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBUyxpQkFBaUIsRUFBNkIsTUFBTSx1QkFBdUIsQ0FBQTtBQWEzRjtJQU1FLDJCQUFZLE9BQWdCLEVBQUUsYUFBcUIsRUFBRSxRQUFzQztRQUN6RixJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxpQkFBaUIsQ0FBQyxPQUFPLEVBQUUsYUFBYSxFQUFFLElBQUksQ0FBQyxDQUFBO1FBQzVFLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFBO1FBQ3hCLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLE9BQU8sQ0FBQTtRQUN0QyxJQUFJLENBQUMsc0JBQXNCLEdBQUcsSUFBSSxPQUFPLENBQUE7SUFDM0MsQ0FBQztJQUVELHNCQUFJLHNDQUFPO2FBQVg7WUFDRSxPQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUE7UUFDdkMsQ0FBQzs7O09BQUE7SUFFRCxpQ0FBSyxHQUFMO1FBQ0UsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEtBQUssRUFBRSxDQUFBO0lBQ2hDLENBQUM7SUFFRCxnQ0FBSSxHQUFKO1FBQ0UsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxDQUFBO0lBQy9CLENBQUM7SUFFRCxtQ0FBTyxHQUFQO1FBQ0UsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sRUFBRSxDQUFBO0lBQ2xDLENBQUM7SUFFRCxzQkFBSSxzQ0FBTzthQUFYO1lBQ0UsT0FBTyxJQUFJLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFBO1FBQ3ZDLENBQUM7OztPQUFBO0lBRUQsc0JBQUksNENBQWE7YUFBakI7WUFDRSxPQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxhQUFhLENBQUE7UUFDN0MsQ0FBQzs7O09BQUE7SUFFRCx3Q0FBWSxHQUFaLFVBQWEsS0FBWTtRQUNmLElBQUEsdUJBQU8sQ0FBVTtRQUNqQixJQUFBLGtEQUFLLENBQXlDO1FBQ3RELElBQUksS0FBSyxFQUFFO1lBQ1QsSUFBSSxDQUFDLDRCQUE0QixDQUFDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUE7WUFDNUQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLENBQUE7U0FDbEQ7SUFDSCxDQUFDO0lBRUQsMENBQWMsR0FBZCxVQUFlLEtBQVk7UUFDakIsSUFBQSx1QkFBTyxDQUFVO1FBQ2pCLElBQUEsa0RBQUssQ0FBeUM7UUFDdEQsSUFBSSxLQUFLLEVBQUU7WUFDVCxJQUFJLENBQUMsNEJBQTRCLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFBO1lBQ3hELElBQUksQ0FBQyxRQUFRLENBQUMscUJBQXFCLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFBO1NBQ3BEO0lBQ0gsQ0FBQztJQUVPLG9EQUF3QixHQUFoQyxVQUFpQyxLQUFZO1FBQzNDLElBQUksV0FBVyxHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDckQsSUFBSSxDQUFDLFdBQVcsRUFBRTtZQUNoQixXQUFXLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQTtZQUNwQyxJQUFJLENBQUMsbUJBQW1CLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxXQUFXLENBQUMsQ0FBQTtTQUNqRDtRQUNELE9BQU8sV0FBVyxDQUFBO0lBQ3BCLENBQUM7SUFFTyx3REFBNEIsR0FBcEMsVUFBcUMsT0FBZ0I7UUFDbkQsSUFBSSxhQUFhLEdBQUcsSUFBSSxDQUFDLHNCQUFzQixDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUM1RCxJQUFJLENBQUMsYUFBYSxFQUFFO1lBQ2xCLGFBQWEsR0FBRyxJQUFJLEdBQUcsQ0FBQTtZQUN2QixJQUFJLENBQUMsc0JBQXNCLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxhQUFhLENBQUMsQ0FBQTtTQUN4RDtRQUNELE9BQU8sYUFBYSxDQUFBO0lBQ3RCLENBQUM7SUFFTyxzQ0FBVSxHQUFsQixVQUFtQixLQUFZO1FBQzdCLElBQUk7WUFDRixJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxDQUFBO1lBQ3JELE9BQU8sRUFBRSxLQUFLLE9BQUEsRUFBRSxDQUFBO1NBQ2pCO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDZCxPQUFPLEVBQUUsS0FBSyxPQUFBLEVBQUUsQ0FBQTtTQUNqQjtJQUNILENBQUM7SUFDSCx3QkFBQztBQUFELENBQUMsQUFqRkQsSUFpRkMifQ==","import { Action } from \"./action\";\nimport { Binding } from \"./binding\";\nimport { ValueListObserver } from \"@stimulus/mutation-observers\";\nvar BindingObserver = /** @class */ (function () {\n    function BindingObserver(context, delegate) {\n        this.context = context;\n        this.delegate = delegate;\n        this.bindingsByAction = new Map;\n    }\n    BindingObserver.prototype.start = function () {\n        if (!this.valueListObserver) {\n            this.valueListObserver = new ValueListObserver(this.element, this.actionAttribute, this);\n            this.valueListObserver.start();\n        }\n    };\n    BindingObserver.prototype.stop = function () {\n        if (this.valueListObserver) {\n            this.valueListObserver.stop();\n            delete this.valueListObserver;\n            this.disconnectAllActions();\n        }\n    };\n    Object.defineProperty(BindingObserver.prototype, \"element\", {\n        get: function () {\n            return this.context.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BindingObserver.prototype, \"identifier\", {\n        get: function () {\n            return this.context.identifier;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BindingObserver.prototype, \"actionAttribute\", {\n        get: function () {\n            return this.schema.actionAttribute;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BindingObserver.prototype, \"schema\", {\n        get: function () {\n            return this.context.schema;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BindingObserver.prototype, \"bindings\", {\n        get: function () {\n            return Array.from(this.bindingsByAction.values());\n        },\n        enumerable: true,\n        configurable: true\n    });\n    BindingObserver.prototype.connectAction = function (action) {\n        var binding = new Binding(this.context, action);\n        this.bindingsByAction.set(action, binding);\n        this.delegate.bindingConnected(binding);\n    };\n    BindingObserver.prototype.disconnectAction = function (action) {\n        var binding = this.bindingsByAction.get(action);\n        if (binding) {\n            this.bindingsByAction.delete(action);\n            this.delegate.bindingDisconnected(binding);\n        }\n    };\n    BindingObserver.prototype.disconnectAllActions = function () {\n        var _this = this;\n        this.bindings.forEach(function (binding) { return _this.delegate.bindingDisconnected(binding); });\n        this.bindingsByAction.clear();\n    };\n    // Value observer delegate\n    BindingObserver.prototype.parseValueForToken = function (token) {\n        var action = Action.forToken(token);\n        if (action.identifier == this.identifier) {\n            return action;\n        }\n    };\n    BindingObserver.prototype.elementMatchedValue = function (element, action) {\n        this.connectAction(action);\n    };\n    BindingObserver.prototype.elementUnmatchedValue = function (element, action) {\n        this.disconnectAction(action);\n    };\n    return BindingObserver;\n}());\nexport { BindingObserver };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmluZGluZ19vYnNlcnZlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9iaW5kaW5nX29ic2VydmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxVQUFVLENBQUE7QUFDakMsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFdBQVcsQ0FBQTtBQUluQyxPQUFPLEVBQVMsaUJBQWlCLEVBQTZCLE1BQU0sOEJBQThCLENBQUE7QUFPbEc7SUFNRSx5QkFBWSxPQUFnQixFQUFFLFFBQWlDO1FBQzdELElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFBO1FBQ3RCLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFBO1FBQ3hCLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLEdBQUcsQ0FBQTtJQUNqQyxDQUFDO0lBRUQsK0JBQUssR0FBTDtRQUNFLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLEVBQUU7WUFDM0IsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksaUJBQWlCLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsZUFBZSxFQUFFLElBQUksQ0FBQyxDQUFBO1lBQ3hGLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLEVBQUUsQ0FBQTtTQUMvQjtJQUNILENBQUM7SUFFRCw4QkFBSSxHQUFKO1FBQ0UsSUFBSSxJQUFJLENBQUMsaUJBQWlCLEVBQUU7WUFDMUIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxDQUFBO1lBQzdCLE9BQU8sSUFBSSxDQUFDLGlCQUFpQixDQUFBO1lBQzdCLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFBO1NBQzVCO0lBQ0gsQ0FBQztJQUVELHNCQUFJLG9DQUFPO2FBQVg7WUFDRSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFBO1FBQzdCLENBQUM7OztPQUFBO0lBRUQsc0JBQUksdUNBQVU7YUFBZDtZQUNFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUE7UUFDaEMsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSw0Q0FBZTthQUFuQjtZQUNFLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxlQUFlLENBQUE7UUFDcEMsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSxtQ0FBTTthQUFWO1lBQ0UsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQTtRQUM1QixDQUFDOzs7T0FBQTtJQUVELHNCQUFJLHFDQUFRO2FBQVo7WUFDRSxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUE7UUFDbkQsQ0FBQzs7O09BQUE7SUFFTyx1Q0FBYSxHQUFyQixVQUFzQixNQUFjO1FBQ2xDLElBQU0sT0FBTyxHQUFHLElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUE7UUFDakQsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUE7UUFDMUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsQ0FBQTtJQUN6QyxDQUFDO0lBRU8sMENBQWdCLEdBQXhCLFVBQXlCLE1BQWM7UUFDckMsSUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQTtRQUNqRCxJQUFJLE9BQU8sRUFBRTtZQUNYLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUE7WUFDcEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLENBQUMsQ0FBQTtTQUMzQztJQUNILENBQUM7SUFFTyw4Q0FBb0IsR0FBNUI7UUFBQSxpQkFHQztRQUZDLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLFVBQUEsT0FBTyxJQUFJLE9BQUEsS0FBSSxDQUFDLFFBQVEsQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLENBQUMsRUFBMUMsQ0FBMEMsQ0FBQyxDQUFBO1FBQzVFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUUsQ0FBQTtJQUMvQixDQUFDO0lBRUQsMEJBQTBCO0lBRTFCLDRDQUFrQixHQUFsQixVQUFtQixLQUFZO1FBQzdCLElBQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDckMsSUFBSSxNQUFNLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUU7WUFDeEMsT0FBTyxNQUFNLENBQUE7U0FDZDtJQUNILENBQUM7SUFFRCw2Q0FBbUIsR0FBbkIsVUFBb0IsT0FBZ0IsRUFBRSxNQUFjO1FBQ2xELElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUE7SUFDNUIsQ0FBQztJQUVELCtDQUFxQixHQUFyQixVQUFzQixPQUFnQixFQUFFLE1BQWM7UUFDcEQsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxDQUFBO0lBQy9CLENBQUM7SUFDSCxzQkFBQztBQUFELENBQUMsQUFsRkQsSUFrRkMifQ==","import { BindingObserver } from \"./binding_observer\";\nvar Context = /** @class */ (function () {\n    function Context(module, scope) {\n        this.module = module;\n        this.scope = scope;\n        this.controller = new module.controllerConstructor(this);\n        this.bindingObserver = new BindingObserver(this, this.dispatcher);\n        try {\n            this.controller.initialize();\n        }\n        catch (error) {\n            this.handleError(error, \"initializing controller\");\n        }\n    }\n    Context.prototype.connect = function () {\n        this.bindingObserver.start();\n        try {\n            this.controller.connect();\n        }\n        catch (error) {\n            this.handleError(error, \"connecting controller\");\n        }\n    };\n    Context.prototype.disconnect = function () {\n        try {\n            this.controller.disconnect();\n        }\n        catch (error) {\n            this.handleError(error, \"disconnecting controller\");\n        }\n        this.bindingObserver.stop();\n    };\n    Object.defineProperty(Context.prototype, \"application\", {\n        get: function () {\n            return this.module.application;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Context.prototype, \"identifier\", {\n        get: function () {\n            return this.module.identifier;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Context.prototype, \"schema\", {\n        get: function () {\n            return this.application.schema;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Context.prototype, \"dispatcher\", {\n        get: function () {\n            return this.application.dispatcher;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Context.prototype, \"element\", {\n        get: function () {\n            return this.scope.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Context.prototype, \"parentElement\", {\n        get: function () {\n            return this.element.parentElement;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // Error handling\n    Context.prototype.handleError = function (error, message, detail) {\n        if (detail === void 0) { detail = {}; }\n        var _a = this, identifier = _a.identifier, controller = _a.controller, element = _a.element;\n        detail = Object.assign({ identifier: identifier, controller: controller, element: element }, detail);\n        this.application.handleError(error, \"Error \" + message, detail);\n    };\n    return Context;\n}());\nexport { Context };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGV4dC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb250ZXh0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQTtBQVFwRDtJQU1FLGlCQUFZLE1BQWMsRUFBRSxLQUFZO1FBQ3RDLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFBO1FBQ3BCLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFBO1FBQ2xCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxNQUFNLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLENBQUE7UUFDeEQsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLGVBQWUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFBO1FBRWpFLElBQUk7WUFDRixJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsRUFBRSxDQUFBO1NBQzdCO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDZCxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSx5QkFBeUIsQ0FBQyxDQUFBO1NBQ25EO0lBQ0gsQ0FBQztJQUVELHlCQUFPLEdBQVA7UUFDRSxJQUFJLENBQUMsZUFBZSxDQUFDLEtBQUssRUFBRSxDQUFBO1FBRTVCLElBQUk7WUFDRixJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sRUFBRSxDQUFBO1NBQzFCO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDZCxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSx1QkFBdUIsQ0FBQyxDQUFBO1NBQ2pEO0lBQ0gsQ0FBQztJQUVELDRCQUFVLEdBQVY7UUFDRSxJQUFJO1lBQ0YsSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLEVBQUUsQ0FBQTtTQUM3QjtRQUFDLE9BQU8sS0FBSyxFQUFFO1lBQ2QsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsMEJBQTBCLENBQUMsQ0FBQTtTQUNwRDtRQUVELElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxFQUFFLENBQUE7SUFDN0IsQ0FBQztJQUVELHNCQUFJLGdDQUFXO2FBQWY7WUFDRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFBO1FBQ2hDLENBQUM7OztPQUFBO0lBRUQsc0JBQUksK0JBQVU7YUFBZDtZQUNFLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUE7UUFDL0IsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSwyQkFBTTthQUFWO1lBQ0UsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQTtRQUNoQyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLCtCQUFVO2FBQWQ7WUFDRSxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFBO1FBQ3BDLENBQUM7OztPQUFBO0lBRUQsc0JBQUksNEJBQU87YUFBWDtZQUNFLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUE7UUFDM0IsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSxrQ0FBYTthQUFqQjtZQUNFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUE7UUFDbkMsQ0FBQzs7O09BQUE7SUFFRCxpQkFBaUI7SUFFakIsNkJBQVcsR0FBWCxVQUFZLEtBQVksRUFBRSxPQUFlLEVBQUUsTUFBbUI7UUFBbkIsdUJBQUEsRUFBQSxXQUFtQjtRQUN0RCxJQUFBLFNBQTBDLEVBQXhDLDBCQUFVLEVBQUUsMEJBQVUsRUFBRSxvQkFBTyxDQUFTO1FBQ2hELE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsVUFBVSxZQUFBLEVBQUUsVUFBVSxZQUFBLEVBQUUsT0FBTyxTQUFBLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQTtRQUNuRSxJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsV0FBUyxPQUFTLEVBQUUsTUFBTSxDQUFDLENBQUE7SUFDakUsQ0FBQztJQUNILGNBQUM7QUFBRCxDQUFDLEFBdEVELElBc0VDIn0=","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/** @hidden */\nexport function blessDefinition(definition) {\n    return {\n        identifier: definition.identifier,\n        controllerConstructor: blessControllerConstructor(definition.controllerConstructor)\n    };\n}\nfunction blessControllerConstructor(controllerConstructor) {\n    var constructor = extend(controllerConstructor);\n    constructor.bless();\n    return constructor;\n}\nvar extend = (function () {\n    function extendWithReflect(constructor) {\n        function Controller() {\n            var _newTarget = this && this instanceof Controller ? this.constructor : void 0;\n            return Reflect.construct(constructor, arguments, _newTarget);\n        }\n        Controller.prototype = Object.create(constructor.prototype, {\n            constructor: { value: Controller }\n        });\n        Reflect.setPrototypeOf(Controller, constructor);\n        return Controller;\n    }\n    function testReflectExtension() {\n        var a = function () { this.a.call(this); };\n        var b = extendWithReflect(a);\n        b.prototype.a = function () { };\n        return new b;\n    }\n    try {\n        testReflectExtension();\n        return extendWithReflect;\n    }\n    catch (error) {\n        return function (constructor) { return /** @class */ (function (_super) {\n            __extends(Controller, _super);\n            function Controller() {\n                return _super !== null && _super.apply(this, arguments) || this;\n            }\n            return Controller;\n        }(constructor)); };\n    }\n})();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVmaW5pdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kZWZpbml0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFPQSxjQUFjO0FBQ2QsTUFBTSwwQkFBMEIsVUFBc0I7SUFDcEQsT0FBTztRQUNMLFVBQVUsRUFBRSxVQUFVLENBQUMsVUFBVTtRQUNqQyxxQkFBcUIsRUFBRSwwQkFBMEIsQ0FBQyxVQUFVLENBQUMscUJBQXFCLENBQUM7S0FDcEYsQ0FBQTtBQUNILENBQUM7QUFFRCxvQ0FBb0MscUJBQTRDO0lBQzlFLElBQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFBO0lBQ2pELFdBQVcsQ0FBQyxLQUFLLEVBQUUsQ0FBQTtJQUNuQixPQUFPLFdBQVcsQ0FBQTtBQUNwQixDQUFDO0FBRUQsSUFBTSxNQUFNLEdBQUcsQ0FBQztJQUdkLDJCQUFzRCxXQUFjO1FBQ2xFOztZQUNFLE9BQU8sT0FBTyxDQUFDLFNBQVMsQ0FBQyxXQUFXLEVBQUUsU0FBUyxhQUFhLENBQUE7UUFDOUQsQ0FBQztRQUVELFVBQVUsQ0FBQyxTQUFTLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsU0FBUyxFQUFFO1lBQzFELFdBQVcsRUFBRSxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUU7U0FDbkMsQ0FBQyxDQUFBO1FBRUYsT0FBTyxDQUFDLGNBQWMsQ0FBQyxVQUFVLEVBQUUsV0FBVyxDQUFDLENBQUE7UUFDL0MsT0FBTyxVQUFpQixDQUFBO0lBQzFCLENBQUM7SUFFRDtRQUNFLElBQU0sQ0FBQyxHQUFHLGNBQXNCLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBLENBQUMsQ0FBUSxDQUFBO1FBQzFELElBQU0sQ0FBQyxHQUFHLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxDQUFBO1FBQzlCLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxHQUFHLGNBQVksQ0FBQyxDQUFBO1FBQzdCLE9BQU8sSUFBSSxDQUFDLENBQUE7SUFDZCxDQUFDO0lBRUQsSUFBSTtRQUNGLG9CQUFvQixFQUFFLENBQUE7UUFDdEIsT0FBTyxpQkFBaUIsQ0FBQTtLQUN6QjtJQUFDLE9BQU8sS0FBSyxFQUFFO1FBQ2QsT0FBTyxVQUE0QixXQUFjLElBQUs7WUFBeUIsOEJBQVc7WUFBcEM7O1lBQXNDLENBQUM7WUFBRCxpQkFBQztRQUFELENBQUMsQUFBdkMsQ0FBeUIsV0FBVyxJQUFwQyxDQUF1QyxDQUFBO0tBQzlGO0FBQ0gsQ0FBQyxDQUFDLEVBQUUsQ0FBQSJ9","import { Context } from \"./context\";\nimport { blessDefinition } from \"./definition\";\nvar Module = /** @class */ (function () {\n    function Module(application, definition) {\n        this.application = application;\n        this.definition = blessDefinition(definition);\n        this.contextsByScope = new WeakMap;\n        this.connectedContexts = new Set;\n    }\n    Object.defineProperty(Module.prototype, \"identifier\", {\n        get: function () {\n            return this.definition.identifier;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Module.prototype, \"controllerConstructor\", {\n        get: function () {\n            return this.definition.controllerConstructor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Module.prototype, \"contexts\", {\n        get: function () {\n            return Array.from(this.connectedContexts);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Module.prototype.connectContextForScope = function (scope) {\n        var context = this.fetchContextForScope(scope);\n        this.connectedContexts.add(context);\n        context.connect();\n    };\n    Module.prototype.disconnectContextForScope = function (scope) {\n        var context = this.contextsByScope.get(scope);\n        if (context) {\n            this.connectedContexts.delete(context);\n            context.disconnect();\n        }\n    };\n    Module.prototype.fetchContextForScope = function (scope) {\n        var context = this.contextsByScope.get(scope);\n        if (!context) {\n            context = new Context(this, scope);\n            this.contextsByScope.set(scope, context);\n        }\n        return context;\n    };\n    return Module;\n}());\nexport { Module };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kdWxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL21vZHVsZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sV0FBVyxDQUFBO0FBRW5DLE9BQU8sRUFBYyxlQUFlLEVBQUUsTUFBTSxjQUFjLENBQUE7QUFHMUQ7SUFNRSxnQkFBWSxXQUF3QixFQUFFLFVBQXNCO1FBQzFELElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFBO1FBQzlCLElBQUksQ0FBQyxVQUFVLEdBQUcsZUFBZSxDQUFDLFVBQVUsQ0FBQyxDQUFBO1FBQzdDLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxPQUFPLENBQUE7UUFDbEMsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksR0FBRyxDQUFBO0lBQ2xDLENBQUM7SUFFRCxzQkFBSSw4QkFBVTthQUFkO1lBQ0UsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQTtRQUNuQyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLHlDQUFxQjthQUF6QjtZQUNFLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxxQkFBcUIsQ0FBQTtRQUM5QyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLDRCQUFRO2FBQVo7WUFDRSxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUE7UUFDM0MsQ0FBQzs7O09BQUE7SUFFRCx1Q0FBc0IsR0FBdEIsVUFBdUIsS0FBWTtRQUNqQyxJQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsb0JBQW9CLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDaEQsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUNuQyxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUE7SUFDbkIsQ0FBQztJQUVELDBDQUF5QixHQUF6QixVQUEwQixLQUFZO1FBQ3BDLElBQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFBO1FBQy9DLElBQUksT0FBTyxFQUFFO1lBQ1gsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQTtZQUN0QyxPQUFPLENBQUMsVUFBVSxFQUFFLENBQUE7U0FDckI7SUFDSCxDQUFDO0lBRU8scUNBQW9CLEdBQTVCLFVBQTZCLEtBQVk7UUFDdkMsSUFBSSxPQUFPLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDN0MsSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNaLE9BQU8sR0FBRyxJQUFJLE9BQU8sQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUE7WUFDbEMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFBO1NBQ3pDO1FBQ0QsT0FBTyxPQUFPLENBQUE7SUFDaEIsQ0FBQztJQUNILGFBQUM7QUFBRCxDQUFDLEFBL0NELElBK0NDIn0=","var DataMap = /** @class */ (function () {\n    function DataMap(scope) {\n        this.scope = scope;\n    }\n    Object.defineProperty(DataMap.prototype, \"element\", {\n        get: function () {\n            return this.scope.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DataMap.prototype, \"identifier\", {\n        get: function () {\n            return this.scope.identifier;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    DataMap.prototype.get = function (key) {\n        key = this.getFormattedKey(key);\n        return this.element.getAttribute(key);\n    };\n    DataMap.prototype.set = function (key, value) {\n        key = this.getFormattedKey(key);\n        this.element.setAttribute(key, value);\n        return this.get(key);\n    };\n    DataMap.prototype.has = function (key) {\n        key = this.getFormattedKey(key);\n        return this.element.hasAttribute(key);\n    };\n    DataMap.prototype.delete = function (key) {\n        if (this.has(key)) {\n            key = this.getFormattedKey(key);\n            this.element.removeAttribute(key);\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    DataMap.prototype.getFormattedKey = function (key) {\n        return \"data-\" + this.identifier + \"-\" + dasherize(key);\n    };\n    return DataMap;\n}());\nexport { DataMap };\nfunction dasherize(value) {\n    return value.replace(/([A-Z])/g, function (_, char) { return \"-\" + char.toLowerCase(); });\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YV9tYXAuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZGF0YV9tYXAudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUE7SUFHRSxpQkFBWSxLQUFZO1FBQ3RCLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFBO0lBQ3BCLENBQUM7SUFFRCxzQkFBSSw0QkFBTzthQUFYO1lBQ0UsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQTtRQUMzQixDQUFDOzs7T0FBQTtJQUVELHNCQUFJLCtCQUFVO2FBQWQ7WUFDRSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFBO1FBQzlCLENBQUM7OztPQUFBO0lBRUQscUJBQUcsR0FBSCxVQUFJLEdBQVc7UUFDYixHQUFHLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUMvQixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0lBQ3ZDLENBQUM7SUFFRCxxQkFBRyxHQUFILFVBQUksR0FBVyxFQUFFLEtBQWE7UUFDNUIsR0FBRyxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDL0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFBO1FBQ3JDLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQTtJQUN0QixDQUFDO0lBRUQscUJBQUcsR0FBSCxVQUFJLEdBQVc7UUFDYixHQUFHLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUMvQixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0lBQ3ZDLENBQUM7SUFFRCx3QkFBTSxHQUFOLFVBQU8sR0FBVztRQUNoQixJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUU7WUFDakIsR0FBRyxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUE7WUFDL0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUE7WUFDakMsT0FBTyxJQUFJLENBQUE7U0FDWjthQUFNO1lBQ0wsT0FBTyxLQUFLLENBQUE7U0FDYjtJQUNILENBQUM7SUFFTyxpQ0FBZSxHQUF2QixVQUF3QixHQUFXO1FBQ2pDLE9BQU8sVUFBUSxJQUFJLENBQUMsVUFBVSxTQUFJLFNBQVMsQ0FBQyxHQUFHLENBQUcsQ0FBQTtJQUNwRCxDQUFDO0lBQ0gsY0FBQztBQUFELENBQUMsQUE1Q0QsSUE0Q0M7O0FBRUQsbUJBQW1CLEtBQWE7SUFDOUIsT0FBTyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxVQUFDLENBQUMsRUFBRSxJQUFJLElBQUssT0FBQSxNQUFJLElBQUksQ0FBQyxXQUFXLEVBQUksRUFBeEIsQ0FBd0IsQ0FBQyxDQUFBO0FBQ3pFLENBQUMifQ==","/** @hidden */\nexport function attributeValueContainsToken(attributeName, token) {\n    return \"[\" + attributeName + \"~=\\\"\" + token + \"\\\"]\";\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VsZWN0b3JzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3NlbGVjdG9ycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxjQUFjO0FBQ2QsTUFBTSxzQ0FBc0MsYUFBcUIsRUFBRSxLQUFhO0lBQzlFLE9BQU8sTUFBSSxhQUFhLFlBQU0sS0FBSyxRQUFJLENBQUE7QUFDekMsQ0FBQyJ9","import { attributeValueContainsToken } from \"./selectors\";\nvar TargetSet = /** @class */ (function () {\n    function TargetSet(scope) {\n        this.scope = scope;\n    }\n    Object.defineProperty(TargetSet.prototype, \"element\", {\n        get: function () {\n            return this.scope.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TargetSet.prototype, \"identifier\", {\n        get: function () {\n            return this.scope.identifier;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TargetSet.prototype, \"schema\", {\n        get: function () {\n            return this.scope.schema;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TargetSet.prototype.has = function (targetName) {\n        return this.find(targetName) != null;\n    };\n    TargetSet.prototype.find = function () {\n        var targetNames = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            targetNames[_i] = arguments[_i];\n        }\n        var selector = this.getSelectorForTargetNames(targetNames);\n        return this.scope.findElement(selector);\n    };\n    TargetSet.prototype.findAll = function () {\n        var targetNames = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            targetNames[_i] = arguments[_i];\n        }\n        var selector = this.getSelectorForTargetNames(targetNames);\n        return this.scope.findAllElements(selector);\n    };\n    TargetSet.prototype.getSelectorForTargetNames = function (targetNames) {\n        var _this = this;\n        return targetNames.map(function (targetName) { return _this.getSelectorForTargetName(targetName); }).join(\", \");\n    };\n    TargetSet.prototype.getSelectorForTargetName = function (targetName) {\n        var targetDescriptor = this.identifier + \".\" + targetName;\n        return attributeValueContainsToken(this.schema.targetAttribute, targetDescriptor);\n    };\n    return TargetSet;\n}());\nexport { TargetSet };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFyZ2V0X3NldC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90YXJnZXRfc2V0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sRUFBRSwyQkFBMkIsRUFBRSxNQUFNLGFBQWEsQ0FBQTtBQUV6RDtJQUdFLG1CQUFZLEtBQVk7UUFDdEIsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUE7SUFDcEIsQ0FBQztJQUVELHNCQUFJLDhCQUFPO2FBQVg7WUFDRSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFBO1FBQzNCLENBQUM7OztPQUFBO0lBRUQsc0JBQUksaUNBQVU7YUFBZDtZQUNFLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUE7UUFDOUIsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSw2QkFBTTthQUFWO1lBQ0UsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQTtRQUMxQixDQUFDOzs7T0FBQTtJQUVELHVCQUFHLEdBQUgsVUFBSSxVQUFrQjtRQUNwQixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksSUFBSSxDQUFBO0lBQ3RDLENBQUM7SUFFRCx3QkFBSSxHQUFKO1FBQUsscUJBQXdCO2FBQXhCLFVBQXdCLEVBQXhCLHFCQUF3QixFQUF4QixJQUF3QjtZQUF4QixnQ0FBd0I7O1FBQzNCLElBQU0sUUFBUSxHQUFHLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxXQUFXLENBQUMsQ0FBQTtRQUM1RCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFBO0lBQ3pDLENBQUM7SUFFRCwyQkFBTyxHQUFQO1FBQVEscUJBQXdCO2FBQXhCLFVBQXdCLEVBQXhCLHFCQUF3QixFQUF4QixJQUF3QjtZQUF4QixnQ0FBd0I7O1FBQzlCLElBQU0sUUFBUSxHQUFHLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxXQUFXLENBQUMsQ0FBQTtRQUM1RCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFBO0lBQzdDLENBQUM7SUFFTyw2Q0FBeUIsR0FBakMsVUFBa0MsV0FBcUI7UUFBdkQsaUJBRUM7UUFEQyxPQUFPLFdBQVcsQ0FBQyxHQUFHLENBQUMsVUFBQSxVQUFVLElBQUksT0FBQSxLQUFJLENBQUMsd0JBQXdCLENBQUMsVUFBVSxDQUFDLEVBQXpDLENBQXlDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDNUYsQ0FBQztJQUVPLDRDQUF3QixHQUFoQyxVQUFpQyxVQUFrQjtRQUNqRCxJQUFNLGdCQUFnQixHQUFNLElBQUksQ0FBQyxVQUFVLFNBQUksVUFBWSxDQUFBO1FBQzNELE9BQU8sMkJBQTJCLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxlQUFlLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQTtJQUNuRixDQUFDO0lBQ0gsZ0JBQUM7QUFBRCxDQUFDLEFBekNELElBeUNDIn0=","import { DataMap } from \"./data_map\";\nimport { TargetSet } from \"./target_set\";\nimport { attributeValueContainsToken } from \"./selectors\";\nvar Scope = /** @class */ (function () {\n    function Scope(schema, identifier, element) {\n        this.schema = schema;\n        this.identifier = identifier;\n        this.element = element;\n        this.targets = new TargetSet(this);\n        this.data = new DataMap(this);\n    }\n    Scope.prototype.findElement = function (selector) {\n        return this.findAllElements(selector)[0];\n    };\n    Scope.prototype.findAllElements = function (selector) {\n        var head = this.element.matches(selector) ? [this.element] : [];\n        var tail = this.filterElements(Array.from(this.element.querySelectorAll(selector)));\n        return head.concat(tail);\n    };\n    Scope.prototype.filterElements = function (elements) {\n        var _this = this;\n        return elements.filter(function (element) { return _this.containsElement(element); });\n    };\n    Scope.prototype.containsElement = function (element) {\n        return element.closest(this.controllerSelector) === this.element;\n    };\n    Object.defineProperty(Scope.prototype, \"controllerSelector\", {\n        get: function () {\n            return attributeValueContainsToken(this.schema.controllerAttribute, this.identifier);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Scope;\n}());\nexport { Scope };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NvcGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc2NvcGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFlBQVksQ0FBQTtBQUVwQyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sY0FBYyxDQUFBO0FBQ3hDLE9BQU8sRUFBRSwyQkFBMkIsRUFBRSxNQUFNLGFBQWEsQ0FBQTtBQUV6RDtJQU9FLGVBQVksTUFBYyxFQUFFLFVBQWtCLEVBQUUsT0FBZ0I7UUFDOUQsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUE7UUFDcEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUE7UUFDNUIsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUE7UUFDdEIsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQTtRQUNsQyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFBO0lBQy9CLENBQUM7SUFFRCwyQkFBVyxHQUFYLFVBQVksUUFBZ0I7UUFDMUIsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBQzFDLENBQUM7SUFFRCwrQkFBZSxHQUFmLFVBQWdCLFFBQWdCO1FBQzlCLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFBO1FBQ2pFLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQTtRQUNyRixPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDMUIsQ0FBQztJQUVELDhCQUFjLEdBQWQsVUFBZSxRQUFtQjtRQUFsQyxpQkFFQztRQURDLE9BQU8sUUFBUSxDQUFDLE1BQU0sQ0FBQyxVQUFBLE9BQU8sSUFBSSxPQUFBLEtBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLEVBQTdCLENBQTZCLENBQUMsQ0FBQTtJQUNsRSxDQUFDO0lBRUQsK0JBQWUsR0FBZixVQUFnQixPQUFnQjtRQUM5QixPQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLEtBQUssSUFBSSxDQUFDLE9BQU8sQ0FBQTtJQUNsRSxDQUFDO0lBRUQsc0JBQVkscUNBQWtCO2FBQTlCO1lBQ0UsT0FBTywyQkFBMkIsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLG1CQUFtQixFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQTtRQUN0RixDQUFDOzs7T0FBQTtJQUNILFlBQUM7QUFBRCxDQUFDLEFBcENELElBb0NDIn0=","import { Scope } from \"./scope\";\nimport { ValueListObserver } from \"@stimulus/mutation-observers\";\nvar ScopeObserver = /** @class */ (function () {\n    function ScopeObserver(element, schema, delegate) {\n        this.element = element;\n        this.schema = schema;\n        this.delegate = delegate;\n        this.valueListObserver = new ValueListObserver(this.element, this.controllerAttribute, this);\n        this.scopesByIdentifierByElement = new WeakMap;\n        this.scopeReferenceCounts = new WeakMap;\n    }\n    ScopeObserver.prototype.start = function () {\n        this.valueListObserver.start();\n    };\n    ScopeObserver.prototype.stop = function () {\n        this.valueListObserver.stop();\n    };\n    Object.defineProperty(ScopeObserver.prototype, \"controllerAttribute\", {\n        get: function () {\n            return this.schema.controllerAttribute;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // Value observer delegate\n    /** @hidden */\n    ScopeObserver.prototype.parseValueForToken = function (token) {\n        var element = token.element, identifier = token.content;\n        var scopesByIdentifier = this.fetchScopesByIdentifierForElement(element);\n        var scope = scopesByIdentifier.get(identifier);\n        if (!scope) {\n            scope = new Scope(this.schema, identifier, element);\n            scopesByIdentifier.set(identifier, scope);\n        }\n        return scope;\n    };\n    /** @hidden */\n    ScopeObserver.prototype.elementMatchedValue = function (element, value) {\n        var referenceCount = (this.scopeReferenceCounts.get(value) || 0) + 1;\n        this.scopeReferenceCounts.set(value, referenceCount);\n        if (referenceCount == 1) {\n            this.delegate.scopeConnected(value);\n        }\n    };\n    /** @hidden */\n    ScopeObserver.prototype.elementUnmatchedValue = function (element, value) {\n        var referenceCount = this.scopeReferenceCounts.get(value);\n        if (referenceCount) {\n            this.scopeReferenceCounts.set(value, referenceCount - 1);\n            if (referenceCount == 1) {\n                this.delegate.scopeDisconnected(value);\n            }\n        }\n    };\n    ScopeObserver.prototype.fetchScopesByIdentifierForElement = function (element) {\n        var scopesByIdentifier = this.scopesByIdentifierByElement.get(element);\n        if (!scopesByIdentifier) {\n            scopesByIdentifier = new Map;\n            this.scopesByIdentifierByElement.set(element, scopesByIdentifier);\n        }\n        return scopesByIdentifier;\n    };\n    return ScopeObserver;\n}());\nexport { ScopeObserver };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NvcGVfb2JzZXJ2ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc2NvcGVfb2JzZXJ2ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLFNBQVMsQ0FBQTtBQUMvQixPQUFPLEVBQVMsaUJBQWlCLEVBQTZCLE1BQU0sOEJBQThCLENBQUE7QUFPbEc7SUFRRSx1QkFBWSxPQUFnQixFQUFFLE1BQWMsRUFBRSxRQUErQjtRQUMzRSxJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQTtRQUN0QixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQTtRQUNwQixJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQTtRQUN4QixJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxJQUFJLENBQUMsQ0FBQTtRQUM1RixJQUFJLENBQUMsMkJBQTJCLEdBQUcsSUFBSSxPQUFPLENBQUE7UUFDOUMsSUFBSSxDQUFDLG9CQUFvQixHQUFHLElBQUksT0FBTyxDQUFBO0lBQ3pDLENBQUM7SUFFRCw2QkFBSyxHQUFMO1FBQ0UsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEtBQUssRUFBRSxDQUFBO0lBQ2hDLENBQUM7SUFFRCw0QkFBSSxHQUFKO1FBQ0UsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxDQUFBO0lBQy9CLENBQUM7SUFFRCxzQkFBSSw4Q0FBbUI7YUFBdkI7WUFDRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsbUJBQW1CLENBQUE7UUFDeEMsQ0FBQzs7O09BQUE7SUFFRCwwQkFBMEI7SUFFMUIsY0FBYztJQUNkLDBDQUFrQixHQUFsQixVQUFtQixLQUFZO1FBQ3JCLElBQUEsdUJBQU8sRUFBRSwwQkFBbUIsQ0FBVTtRQUM5QyxJQUFNLGtCQUFrQixHQUFHLElBQUksQ0FBQyxpQ0FBaUMsQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUUxRSxJQUFJLEtBQUssR0FBRyxrQkFBa0IsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUE7UUFDOUMsSUFBSSxDQUFDLEtBQUssRUFBRTtZQUNWLEtBQUssR0FBRyxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLFVBQVUsRUFBRSxPQUFPLENBQUMsQ0FBQTtZQUNuRCxrQkFBa0IsQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLEtBQUssQ0FBQyxDQUFBO1NBQzFDO1FBRUQsT0FBTyxLQUFLLENBQUE7SUFDZCxDQUFDO0lBRUQsY0FBYztJQUNkLDJDQUFtQixHQUFuQixVQUFvQixPQUFnQixFQUFFLEtBQVk7UUFDaEQsSUFBTSxjQUFjLEdBQUcsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUN0RSxJQUFJLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxjQUFjLENBQUMsQ0FBQTtRQUNwRCxJQUFJLGNBQWMsSUFBSSxDQUFDLEVBQUU7WUFDdkIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUE7U0FDcEM7SUFDSCxDQUFDO0lBRUQsY0FBYztJQUNkLDZDQUFxQixHQUFyQixVQUFzQixPQUFnQixFQUFFLEtBQVk7UUFDbEQsSUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUMzRCxJQUFJLGNBQWMsRUFBRTtZQUNsQixJQUFJLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxjQUFjLEdBQUcsQ0FBQyxDQUFDLENBQUE7WUFDeEQsSUFBSSxjQUFjLElBQUksQ0FBQyxFQUFFO2dCQUN2QixJQUFJLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFBO2FBQ3ZDO1NBQ0Y7SUFDSCxDQUFDO0lBRU8seURBQWlDLEdBQXpDLFVBQTBDLE9BQWdCO1FBQ3hELElBQUksa0JBQWtCLEdBQUcsSUFBSSxDQUFDLDJCQUEyQixDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUN0RSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDdkIsa0JBQWtCLEdBQUcsSUFBSSxHQUFHLENBQUE7WUFDNUIsSUFBSSxDQUFDLDJCQUEyQixDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsa0JBQWtCLENBQUMsQ0FBQTtTQUNsRTtRQUNELE9BQU8sa0JBQWtCLENBQUE7SUFDM0IsQ0FBQztJQUNILG9CQUFDO0FBQUQsQ0FBQyxBQXpFRCxJQXlFQyJ9","import { Module } from \"./module\";\nimport { Multimap } from \"@stimulus/multimap\";\nimport { ScopeObserver } from \"./scope_observer\";\nvar Router = /** @class */ (function () {\n    function Router(application) {\n        this.application = application;\n        this.scopeObserver = new ScopeObserver(this.element, this.schema, this);\n        this.scopesByIdentifier = new Multimap;\n        this.modulesByIdentifier = new Map;\n    }\n    Object.defineProperty(Router.prototype, \"element\", {\n        get: function () {\n            return this.application.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Router.prototype, \"schema\", {\n        get: function () {\n            return this.application.schema;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Router.prototype, \"controllerAttribute\", {\n        get: function () {\n            return this.schema.controllerAttribute;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Router.prototype, \"modules\", {\n        get: function () {\n            return Array.from(this.modulesByIdentifier.values());\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Router.prototype, \"contexts\", {\n        get: function () {\n            return this.modules.reduce(function (contexts, module) { return contexts.concat(module.contexts); }, []);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Router.prototype.start = function () {\n        this.scopeObserver.start();\n    };\n    Router.prototype.stop = function () {\n        this.scopeObserver.stop();\n    };\n    Router.prototype.loadDefinition = function (definition) {\n        this.unloadIdentifier(definition.identifier);\n        var module = new Module(this.application, definition);\n        this.connectModule(module);\n    };\n    Router.prototype.unloadIdentifier = function (identifier) {\n        var module = this.modulesByIdentifier.get(identifier);\n        if (module) {\n            this.disconnectModule(module);\n        }\n    };\n    Router.prototype.getContextForElementAndIdentifier = function (element, identifier) {\n        var module = this.modulesByIdentifier.get(identifier);\n        if (module) {\n            return module.contexts.find(function (context) { return context.element == element; });\n        }\n    };\n    // Error handler delegate\n    /** @hidden */\n    Router.prototype.handleError = function (error, message, detail) {\n        this.application.handleError(error, message, detail);\n    };\n    // Scope observer delegate\n    /** @hidden */\n    Router.prototype.scopeConnected = function (scope) {\n        this.scopesByIdentifier.add(scope.identifier, scope);\n        var module = this.modulesByIdentifier.get(scope.identifier);\n        if (module) {\n            module.connectContextForScope(scope);\n        }\n    };\n    /** @hidden */\n    Router.prototype.scopeDisconnected = function (scope) {\n        this.scopesByIdentifier.delete(scope.identifier, scope);\n        var module = this.modulesByIdentifier.get(scope.identifier);\n        if (module) {\n            module.disconnectContextForScope(scope);\n        }\n    };\n    // Modules\n    Router.prototype.connectModule = function (module) {\n        this.modulesByIdentifier.set(module.identifier, module);\n        var scopes = this.scopesByIdentifier.getValuesForKey(module.identifier);\n        scopes.forEach(function (scope) { return module.connectContextForScope(scope); });\n    };\n    Router.prototype.disconnectModule = function (module) {\n        this.modulesByIdentifier.delete(module.identifier);\n        var scopes = this.scopesByIdentifier.getValuesForKey(module.identifier);\n        scopes.forEach(function (scope) { return module.disconnectContextForScope(scope); });\n    };\n    return Router;\n}());\nexport { Router };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3JvdXRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sVUFBVSxDQUFBO0FBQ2pDLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQTtBQUc3QyxPQUFPLEVBQUUsYUFBYSxFQUF5QixNQUFNLGtCQUFrQixDQUFBO0FBRXZFO0lBTUUsZ0JBQVksV0FBd0I7UUFDbEMsSUFBSSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUE7UUFDOUIsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLGFBQWEsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUE7UUFDdkUsSUFBSSxDQUFDLGtCQUFrQixHQUFHLElBQUksUUFBUSxDQUFBO1FBQ3RDLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLEdBQUcsQ0FBQTtJQUNwQyxDQUFDO0lBRUQsc0JBQUksMkJBQU87YUFBWDtZQUNFLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUE7UUFDakMsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSwwQkFBTTthQUFWO1lBQ0UsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQTtRQUNoQyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLHVDQUFtQjthQUF2QjtZQUNFLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxtQkFBbUIsQ0FBQTtRQUN4QyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLDJCQUFPO2FBQVg7WUFDRSxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUE7UUFDdEQsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSw0QkFBUTthQUFaO1lBQ0UsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FB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","export var defaultSchema = {\n    controllerAttribute: \"data-controller\",\n    actionAttribute: \"data-action\",\n    targetAttribute: \"data-target\"\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NoZW1hLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3NjaGVtYS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFNQSxNQUFNLENBQUMsSUFBTSxhQUFhLEdBQVc7SUFDbkMsbUJBQW1CLEVBQUUsaUJBQWlCO0lBQ3RDLGVBQWUsRUFBRSxhQUFhO0lBQzlCLGVBQWUsRUFBRSxhQUFhO0NBQy9CLENBQUEifQ==","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { Dispatcher } from \"./dispatcher\";\nimport { Router } from \"./router\";\nimport { defaultSchema } from \"./schema\";\nvar Application = /** @class */ (function () {\n    function Application(element, schema) {\n        if (element === void 0) { element = document.documentElement; }\n        if (schema === void 0) { schema = defaultSchema; }\n        this.element = element;\n        this.schema = schema;\n        this.dispatcher = new Dispatcher(this);\n        this.router = new Router(this);\n    }\n    Application.start = function (element, schema) {\n        var application = new Application(element, schema);\n        application.start();\n        return application;\n    };\n    Application.prototype.start = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, domReady()];\n                    case 1:\n                        _a.sent();\n                        this.router.start();\n                        this.dispatcher.start();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Application.prototype.stop = function () {\n        this.router.stop();\n        this.dispatcher.stop();\n    };\n    Application.prototype.register = function (identifier, controllerConstructor) {\n        this.load({ identifier: identifier, controllerConstructor: controllerConstructor });\n    };\n    Application.prototype.load = function (head) {\n        var _this = this;\n        var rest = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            rest[_i - 1] = arguments[_i];\n        }\n        var definitions = Array.isArray(head) ? head : [head].concat(rest);\n        definitions.forEach(function (definition) { return _this.router.loadDefinition(definition); });\n    };\n    Application.prototype.unload = function (head) {\n        var _this = this;\n        var rest = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            rest[_i - 1] = arguments[_i];\n        }\n        var identifiers = Array.isArray(head) ? head : [head].concat(rest);\n        identifiers.forEach(function (identifier) { return _this.router.unloadIdentifier(identifier); });\n    };\n    Object.defineProperty(Application.prototype, \"controllers\", {\n        // Controllers\n        get: function () {\n            return this.router.contexts.map(function (context) { return context.controller; });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Application.prototype.getControllerForElementAndIdentifier = function (element, identifier) {\n        var context = this.router.getContextForElementAndIdentifier(element, identifier);\n        return context ? context.controller : null;\n    };\n    // Error handling\n    Application.prototype.handleError = function (error, message, detail) {\n        console.error(\"%s\\n\\n%o\\n\\n%o\", message, error, detail);\n    };\n    return Application;\n}());\nexport { Application };\nfunction domReady() {\n    return new Promise(function (resolve) {\n        if (document.readyState == \"loading\") {\n            document.addEventListener(\"DOMContentLoaded\", resolve);\n        }\n        else {\n            resolve();\n        }\n    });\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwbGljYXRpb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvYXBwbGljYXRpb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sY0FBYyxDQUFBO0FBRXpDLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxVQUFVLENBQUE7QUFDakMsT0FBTyxFQUFVLGFBQWEsRUFBRSxNQUFNLFVBQVUsQ0FBQTtBQUVoRDtJQVlFLHFCQUFZLE9BQTJDLEVBQUUsTUFBOEI7UUFBM0Usd0JBQUEsRUFBQSxVQUFtQixRQUFRLENBQUMsZUFBZTtRQUFFLHVCQUFBLEVBQUEsc0JBQThCO1FBQ3JGLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFBO1FBQ3RCLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFBO1FBQ3BCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUE7UUFDdEMsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQTtJQUNoQyxDQUFDO0lBWE0saUJBQUssR0FBWixVQUFhLE9BQWlCLEVBQUUsTUFBZTtRQUM3QyxJQUFNLFdBQVcsR0FBRyxJQUFJLFdBQVcsQ0FBQyxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUE7UUFDcEQsV0FBVyxDQUFDLEtBQUssRUFBRSxDQUFBO1FBQ25CLE9BQU8sV0FBVyxDQUFBO0lBQ3BCLENBQUM7SUFTSywyQkFBSyxHQUFYOzs7OzRCQUNFLHFCQUFNLFFBQVEsRUFBRSxFQUFBOzt3QkFBaEIsU0FBZ0IsQ0FBQTt3QkFDaEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQTt3QkFDbkIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsQ0FBQTs7Ozs7S0FDeEI7SUFFRCwwQkFBSSxHQUFKO1FB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","/** @hidden */\nexport function defineTargetProperties(constructor) {\n    var prototype = constructor.prototype;\n    var targetNames = getTargetNamesForConstructor(constructor);\n    targetNames.forEach(function (name) {\n        var _a;\n        return defineLinkedProperties(prototype, (_a = {},\n            _a[name + \"Target\"] = {\n                get: function () {\n                    var target = this.targets.find(name);\n                    if (target) {\n                        return target;\n                    }\n                    else {\n                        throw new Error(\"Missing target element \\\"\" + this.identifier + \".\" + name + \"\\\"\");\n                    }\n                }\n            },\n            _a[name + \"Targets\"] = {\n                get: function () {\n                    return this.targets.findAll(name);\n                }\n            },\n            _a[\"has\" + capitalize(name) + \"Target\"] = {\n                get: function () {\n                    return this.targets.has(name);\n                }\n            },\n            _a));\n    });\n}\nfunction getTargetNamesForConstructor(constructor) {\n    var ancestors = getAncestorsForConstructor(constructor);\n    return Array.from(ancestors.reduce(function (targetNames, constructor) {\n        getOwnTargetNamesForConstructor(constructor).forEach(function (name) { return targetNames.add(name); });\n        return targetNames;\n    }, new Set));\n}\nfunction getAncestorsForConstructor(constructor) {\n    var ancestors = [];\n    while (constructor) {\n        ancestors.push(constructor);\n        constructor = Object.getPrototypeOf(constructor);\n    }\n    return ancestors;\n}\nfunction getOwnTargetNamesForConstructor(constructor) {\n    var definition = constructor[\"targets\"];\n    return Array.isArray(definition) ? definition : [];\n}\nfunction defineLinkedProperties(object, properties) {\n    Object.keys(properties).forEach(function (name) {\n        if (!(name in object)) {\n            var descriptor = properties[name];\n            Object.defineProperty(object, name, descriptor);\n        }\n    });\n}\nfunction capitalize(name) {\n    return name.charAt(0).toUpperCase() + name.slice(1);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFyZ2V0X3Byb3BlcnRpZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdGFyZ2V0X3Byb3BlcnRpZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsY0FBYztBQUNkLE1BQU0saUNBQWlDLFdBQXFCO0lBQzFELElBQU0sU0FBUyxHQUFHLFdBQVcsQ0FBQyxTQUFTLENBQUE7SUFDdkMsSUFBTSxXQUFXLEdBQUcsNEJBQTRCLENBQUMsV0FBVyxDQUFDLENBQUE7SUFDN0QsV0FBVyxDQUFDLE9BQU8sQ0FBQyxVQUFBLElBQUk7O1FBQUksT0FBQSxzQkFBc0IsQ0FBQyxTQUFTO1lBQzFELEdBQUksSUFBSSxXQUFRLElBQUc7Z0JBQ2pCLEdBQUc7b0JBQ0QsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUE7b0JBQ3RDLElBQUksTUFBTSxFQUFFO3dCQUNWLE9BQU8sTUFBTSxDQUFBO3FCQUNkO3lCQUFNO3dCQUNMLE1BQU0sSUFBSSxLQUFLLENBQUMsOEJBQTJCLElBQUksQ0FBQyxVQUFVLFNBQUksSUFBSSxPQUFHLENBQUMsQ0FBQTtxQkFDdkU7Z0JBQ0gsQ0FBQzthQUNGO1lBQ0QsR0FBSSxJQUFJLFlBQVMsSUFBRztnQkFDbEIsR0FBRztvQkFDRCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFBO2dCQUNuQyxDQUFDO2FBQ0Y7WUFDRCxHQUFDLFFBQU0sVUFBVSxDQUFDLElBQUksQ0FBQyxXQUFRLElBQUc7Z0JBQ2hDLEdBQUc7b0JBQ0QsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQTtnQkFDL0IsQ0FBQzthQUNGO2dCQUNEO0lBckIwQixDQXFCMUIsQ0FBQyxDQUFBO0FBQ0wsQ0FBQztBQUVELHNDQUFzQyxXQUFxQjtJQUN6RCxJQUFNLFNBQVMsR0FBRywwQkFBMEIsQ0FBQyxXQUFXLENBQUMsQ0FBQTtJQUN6RCxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxVQUFDLFdBQVcsRUFBRSxXQUFXO1FBQzFELCtCQUErQixDQUFDLFdBQVcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFBLElBQUksSUFBSSxPQUFBLFdBQVcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQXJCLENBQXFCLENBQUMsQ0FBQTtRQUNuRixPQUFPLFdBQVcsQ0FBQTtJQUNwQixDQUFDLEVBQUUsSUFBSSxHQUFrQixDQUFDLENBQUMsQ0FBQTtBQUM3QixDQUFDO0FBRUQsb0NBQW9DLFdBQXFCO0lBQ3ZELElBQU0sU0FBUyxHQUFlLEVBQUUsQ0FBQTtJQUNoQyxPQUFPLFdBQVcsRUFBRTtRQUNsQixTQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFBO1FBQzNCLFdBQVcsR0FBRyxNQUFNLENBQUMsY0FBYyxDQUFDLFdBQVcsQ0FBQyxDQUFBO0tBQ2pEO0lBQ0QsT0FBTyxTQUFTLENBQUE7QUFDbEIsQ0FBQztBQUVELHlDQUF5QyxXQUFxQjtJQUM1RCxJQUFNLFVBQVUsR0FBSSxXQUFtQixDQUFDLFNBQVMsQ0FBQyxDQUFBO0lBQ2xELE9BQU8sS0FBSyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUE7QUFDcEQsQ0FBQztBQUVELGdDQUFnQyxNQUFXLEVBQUUsVUFBaUM7SUFDNUUsTUFBTSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBQyxJQUFJO1FBQ25DLElBQUksQ0FBQyxDQUFDLElBQUksSUFBSSxNQUFNLENBQUMsRUFBRTtZQUNyQixJQUFNLFVBQVUsR0FBRyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUE7WUFDbkMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLFVBQVUsQ0FBQyxDQUFBO1NBQ2hEO0lBQ0gsQ0FBQyxDQUFDLENBQUE7QUFDSixDQUFDO0FBRUQsb0JBQW9CLElBQVk7SUFDOUIsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDckQsQ0FBQyJ9","import { defineTargetProperties } from \"./target_properties\";\nvar Controller = /** @class */ (function () {\n    function Controller(context) {\n        this.context = context;\n    }\n    Controller.bless = function () {\n        defineTargetProperties(this);\n    };\n    Object.defineProperty(Controller.prototype, \"application\", {\n        get: function () {\n            return this.context.application;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Controller.prototype, \"scope\", {\n        get: function () {\n            return this.context.scope;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Controller.prototype, \"element\", {\n        get: function () {\n            return this.scope.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Controller.prototype, \"identifier\", {\n        get: function () {\n            return this.scope.identifier;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Controller.prototype, \"targets\", {\n        get: function () {\n            return this.scope.targets;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Controller.prototype, \"data\", {\n        get: function () {\n            return this.scope.data;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Controller.prototype.initialize = function () {\n        // Override in your subclass to set up initial controller state\n    };\n    Controller.prototype.connect = function () {\n        // Override in your subclass to respond when the controller is connected to the DOM\n    };\n    Controller.prototype.disconnect = function () {\n        // Override in your subclass to respond when the controller is disconnected from the DOM\n    };\n    Controller.targets = [];\n    return Controller;\n}());\nexport { Controller };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udHJvbGxlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUtBLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLHFCQUFxQixDQUFBO0FBTzVEO0lBU0Usb0JBQVksT0FBZ0I7UUFDMUIsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUE7SUFDeEIsQ0FBQztJQU5NLGdCQUFLLEdBQVo7UUFDRSxzQkFBc0IsQ0FBQyxJQUFJLENBQUMsQ0FBQTtJQUM5QixDQUFDO0lBTUQsc0JBQUksbUNBQVc7YUFBZjtZQUNFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUE7UUFDakMsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSw2QkFBSzthQUFUO1lBQ0UsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQTtRQUMzQixDQUFDOzs7T0FBQTtJQUVELHNCQUFJLCtCQUFPO2FBQVg7WUFDRSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFBO1FBQzNCLENBQUM7OztPQUFBO0lBRUQsc0JBQUksa0NBQVU7YUFBZDtZQUNFLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUE7UUFDOUIsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSwrQkFBTzthQUFYO1lBQ0UsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQTtRQUMzQixDQUFDOzs7T0FBQTtJQUVELHNCQUFJLDRCQUFJO2FBQVI7WUFDRSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFBO1FBQ3hCLENBQUM7OztPQUFBO0lBRUQsK0JBQVUsR0FBVjtRQUNFLCtEQUErRDtJQUNqRSxDQUFDO0lBRUQsNEJBQU8sR0FBUDtRQUNFLG1GQUFtRjtJQUNyRixDQUFDO0lBRUQsK0JBQVUsR0FBVjtRQUNFLHdGQUF3RjtJQUMxRixDQUFDO0lBOUNNLGtCQUFPLEdBQWEsRUFBRSxDQUFBO0lBK0MvQixpQkFBQztDQUFBLEFBaERELElBZ0RDO1NBaERZLFVBQVUifQ==","import { Application } from 'stimulus';\nimport { definitionsFromContext } from 'stimulus/webpack-helpers';\n\nconst application = Application.start();\nconst context = require.context('./controllers', true, /\\.js$/);\napplication.load(definitionsFromContext(context));\n\n","export function definitionsFromContext(context) {\n    return context.keys()\n        .map(function (key) { return definitionForModuleWithContextAndKey(context, key); })\n        .filter(function (value) { return value; });\n}\nfunction definitionForModuleWithContextAndKey(context, key) {\n    var identifier = identifierForContextKey(key);\n    if (identifier) {\n        return definitionForModuleAndIdentifier(context(key), identifier);\n    }\n}\nfunction definitionForModuleAndIdentifier(module, identifier) {\n    var controllerConstructor = module.default;\n    if (typeof controllerConstructor == \"function\") {\n        return { identifier: identifier, controllerConstructor: controllerConstructor };\n    }\n}\nexport function identifierForContextKey(key) {\n    var logicalName = (key.match(/^(?:\\.\\/)?(.+)(?:[_-]controller\\..+?)$/) || [])[1];\n    if (logicalName) {\n        return logicalName.replace(/_/g, \"-\").replace(/\\//g, \"--\");\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFPQSxNQUFNLGlDQUFpQyxPQUEwQztJQUMvRSxPQUFPLE9BQU8sQ0FBQyxJQUFJLEVBQUU7U0FDbEIsR0FBRyxDQUFDLFVBQUEsR0FBRyxJQUFJLE9BQUEsb0NBQW9DLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxFQUFsRCxDQUFrRCxDQUFDO1NBQzlELE1BQU0sQ0FBQyxVQUFBLEtBQUssSUFBSSxPQUFBLEtBQUssRUFBTCxDQUFLLENBQWlCLENBQUE7QUFDM0MsQ0FBQztBQUVELDhDQUE4QyxPQUEwQyxFQUFFLEdBQVc7SUFDbkcsSUFBTSxVQUFVLEdBQUcsdUJBQXVCLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDL0MsSUFBSSxVQUFVLEVBQUU7UUFDZCxPQUFPLGdDQUFnQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRSxVQUFVLENBQUMsQ0FBQTtLQUNsRTtBQUNILENBQUM7QUFFRCwwQ0FBMEMsTUFBd0IsRUFBRSxVQUFrQjtJQUNwRixJQUFNLHFCQUFxQixHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUE7SUFDNUMsSUFBSSxPQUFPLHFCQUFxQixJQUFJLFVBQVUsRUFBRTtRQUM5QyxPQUFPLEVBQUUsVUFBVSxZQUFBLEVBQUUscUJBQXFCLHVCQUFBLEVBQUUsQ0FBQTtLQUM3QztBQUNILENBQUM7QUFFRCxNQUFNLGtDQUFrQyxHQUFXO0lBQ2pELElBQU0sV0FBVyxHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyx3Q0FBd0MsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBQ2xGLElBQUksV0FBVyxFQUFFO1FBQ2YsT0FBTyxXQUFXLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFBO0tBQzNEO0FBQ0gsQ0FBQyJ9","import {Controller} from 'stimulus';\n\nexport default class extends Controller {\n\n    /**\n     *\n     * @param event\n     */\n    openVK(event) {\n        this.popupCenter('http://vk.com/share.php?url=', '', 600, 400);\n    }\n\n    /**\n     *\n     * @param event\n     */\n    openOk(event) {\n        this.popupCenter('http://www.ok.ru/dk?st.cmd=addShare&st.s=1&st._surl=', '', 600, 400);\n    }\n\n    /**\n     *\n     * @param event\n     */\n    openFacebook(event) {\n        this.popupCenter('http://www.facebook.com/sharer.php?u=', '', 600, 400);\n    }\n\n    /**\n     *\n     * @param event\n     */\n    openTwitter(event) {\n        this.popupCenter('https://twitter.com/share?url=', '', 600, 400);\n    }\n\n    /**\n     *\n     * @param url\n     * @param title\n     * @param w\n     * @param h\n     * @returns {Window}\n     */\n    popupCenter(url, title, w, h) {\n        let left = (screen.width / 2) - (w / 2);\n        let top = (screen.height / 2) - (h / 2);\n\n        return window.open(url, title, 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=' + w + ', height=' + h + ', top=' + top + ', left=' + left);\n    }\n}\n","var map = {\n\t\"./current_time_controller.js\": \"8LWa\",\n\t\"./news_controller.js\": \"5Esp\",\n\t\"./news_time_controller.js\": \"AP75\",\n\t\"./redirect_controller.js\": \"OHuu\",\n\t\"./share_controller.js\": \"crVL\",\n\t\"./story_items_controller.js\": \"OxMT\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"jiIp\";","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","module.exports = require(\"regenerator-runtime\");\n"],"sourceRoot":""}